(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{155:function(e,t,a){e.exports=a.p+"static/media/album2.d2a4d59b.jpg"},156:function(e,t,a){e.exports=a.p+"static/media/album3.d87defa9.jpg"},167:function(e,t,a){e.exports=a.p+"static/media/default.34a8da70.mp3"},183:function(e,t,a){e.exports=a(246)},189:function(e,t,a){},190:function(e,t,a){},245:function(e,t,a){},246:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(28),l=a.n(s),c=a(168),i=a(45),o=a(22);a(188),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(189),a(190);var u=a(5),d=a.n(u),m=a(10),p=a(12),f=a(13),g=a(15),h=a(14),b=a(16),v=a(75),E=a(77),k=a(78),y=a.n(k),x=a(155),S=a.n(x),C=a(156),O=a.n(C),I=a(56),w=a.n(I),N=function(e){function t(){return Object(p.a)(this,t),Object(g.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props.playlist;return r.a.createElement("div",null,r.a.createElement(o.b,{to:"/playlist/"+e._id,style:{color:"#ed4e85"}},r.a.createElement("div",{className:"album-card"},r.a.createElement("img",{className:"playlist-image",src:w.a,width:150,height:150,alt:""}),r.a.createElement("div",null,e.musicListName))))}}]),t}(n.Component),_=a(158),j=a.n(_),P=a(71),L=j.a.create({baseURL:P.url.server+"/api"}),A=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).getPublicPlaylists=Object(m.a)(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L.get("/randomPlaylists");case 3:"success"===(t=e.sent).data.status&&(n=t.data.playlists,a.setState({publicPlaylists:n})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])})),a.state={publicPlaylists:[]},a}return Object(b.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.getPublicPlaylists()}},{key:"render",value:function(){var e="";return this.state.publicPlaylists&&(e=this.state.publicPlaylists.map(function(e,t){return r.a.createElement("div",{key:t},r.a.createElement(N,{className:"grid-item",playlist:e}))})),r.a.createElement("div",null,r.a.createElement(E.a,null,r.a.createElement(E.a.Item,null,r.a.createElement("div",{className:"feature-album"},r.a.createElement("img",{className:"d-block w-100",src:S.a,alt:"First slide"})),r.a.createElement(E.a.Caption,null,r.a.createElement("h3",null,"First slide label"),r.a.createElement("p",null,"Nulla vitae elit libero, a pharetra augue mollis interdum."))),r.a.createElement(E.a.Item,null,r.a.createElement("div",{className:"feature-album"},r.a.createElement("img",{className:"d-block w-100",src:y.a,alt:"Second slide"})),r.a.createElement(E.a.Caption,null,r.a.createElement("h3",null,"Second slide label"),r.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit."))),r.a.createElement(E.a.Item,null,r.a.createElement("div",{className:"feature-album"},r.a.createElement("img",{className:"d-block w-100",src:O.a,alt:"Third slide"})),r.a.createElement(E.a.Caption,null,r.a.createElement("h3",null,"Third slide label"),r.a.createElement("p",null,"Praesent commodo cursus magna, vel scelerisque nisl consectetur.")))),r.a.createElement("h1",null,"Trending Playlists"),r.a.createElement("div",{className:"border-bottom-accent"}),r.a.createElement("div",{className:"grid-container"},e))}}]),t}(n.Component),M=a(60),T=a(17),z=a(4),H=a(21),F=a(26),q=a(0),D=function(e){function t(){var e;return Object(p.a)(this,t),(e=Object(g.a)(this,Object(h.a)(t).call(this))).updateNowPlaying=function(){var t=Object(m.a)(d.a.mark(function t(a){var n;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=5;break}return t.next=3,L.get("/music/"+a);case 3:"success"===(n=t.sent).data.status?(e.setState({now_playing_ID:a}),e.setState({now_playing:n.data.music.musicName})):console.log("error searching song");case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),e.state={now_playing:"none",now_playing_ID:""},e}return Object(b.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){"none"!==this.props.user.nowListening?this.updateNowPlaying(this.props.user.nowListening):this.setState({now_playing:"none"}),"none"!==this.props.now_playing?this.updateNowPlaying(this.props.now_playing):this.setState({now_playing:"none"})}},{key:"componentWillReceiveProps",value:function(e){"none"!==e.user.nowListening?this.updateNowPlaying(e.user.nowListening):this.setState({now_playing:"none"}),"none"!==e.now_playing?this.updateNowPlaying(e.now_playing):this.setState({now_playing:"none"})}},{key:"render",value:function(){var e="",t=this.state.now_playing;this.props.user&&(e=this.props.user.nickName,this.props.user._id);var a="",n={},s="";return this.state.now_playing&&(s="none"!==t?r.a.createElement(o.b,{to:"/song/"+this.state.now_playing_ID},r.a.createElement("h6",null,"Last Playing: ",t)):r.a.createElement("h6",null,"Last Playing: ",t)),this.props.isOffline?(a=r.a.createElement(q.b.Provider,{value:{color:"#ACACAC",size:"50px"}},r.a.createElement(F.c,null)),n={color:"#ACACAC"},s=r.a.createElement("h6",{style:{color:"#ACACAC"}},"Offline")):(a=r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"50px"}},r.a.createElement(F.c,null)),s="none"!==t?r.a.createElement(o.b,{to:"/song/"+this.state.now_playing_ID},r.a.createElement("h6",null,"Last Playing: ",t)):r.a.createElement("h6",null,"Last Playing: ",t)),r.a.createElement("div",{className:"m-3",style:n},r.a.createElement(H.a,null,r.a.createElement(T.a,{style:{border:"3px solid",padding:"30px",borderRadius:"5px"}},r.a.createElement(z.a,{xs:3,className:"content-center"},a),r.a.createElement(z.a,{xs:9},r.a.createElement("h4",null,e),s))))}}]),t}(n.Component),B=a(18),R=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(g.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).onAcceptClick=Object(m.a)(d.a.mark(function e(){var t,n,r,s,l;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t="",n=localStorage.getItem("userId"),a.props.user&&(t=a.props.user._id),!t||!n){e.next=14;break}return e.prev=4,e.next=7,L.post("/acceptFriendRequest",{userID:n,target_userID:t});case 7:"success"===(r=e.sent).data.status&&(s=r.data.user,(l=a.props.childSetFriendsAndRequest)&&l(s)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),console.log(e.t0);case 14:case"end":return e.stop()}},e,null,[[4,11]])})),a.onDeclineClick=Object(m.a)(d.a.mark(function e(){var t,n,r,s,l;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t="",n=localStorage.getItem("userId"),a.props.user&&(t=a.props.user._id),!t||!n){e.next=14;break}return e.prev=4,e.next=7,L.post("/declineFriendRequest",{userID:n,target_userID:t});case 7:"success"===(r=e.sent).data.status&&(s=r.data.user,(l=a.props.childSetFriendsAndRequest)&&l(s)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),console.log(e.t0);case 14:case"end":return e.stop()}},e,null,[[4,11]])})),a}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e="",t="";return this.props.user&&(e=this.props.user.nickName,t=this.props.user._id),r.a.createElement("div",{className:"m-5"},r.a.createElement(H.a,null,r.a.createElement(T.a,null,r.a.createElement(z.a,{xs:3,className:"content-center"},r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"50px"}},r.a.createElement(F.c,null))),r.a.createElement(z.a,{xs:9},r.a.createElement(o.b,{to:"/profile/"+t},r.a.createElement("h4",null,e)),r.a.createElement(B.a,{onClick:this.onAcceptClick,className:"search-btn"},"Accept"),r.a.createElement(B.a,{onClick:this.onDeclineClick,className:"search-btn"},"Decline")))))}}]),t}(n.Component),U=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).childSetFriendsAndRequest=function(e){a.setState({user:e}),a.getFriendsAndRequests()},a.getUser=Object(m.a)(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=localStorage.getItem("userId"))){e.next=11;break}return e.prev=2,e.next=5,L.post("/user",{id:t});case 5:"success"===(n=e.sent).data.status&&(a.setState({user:n.data.user}),a.getFriendsAndRequests()),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(2);case 11:case"end":return e.stop()}},e,null,[[2,9]])})),a.getFriendsAndRequests=Object(m.a)(d.a.mark(function e(){var t,n,r,s,l,c,i,o,u;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=a.state.user)){e.next=27;break}n=t.friends,r=[],s=0;case 5:if(!(s<n.length)){e.next=13;break}return e.next=8,L.post("/user",{id:n[s]});case 8:"success"===(l=e.sent).data.status&&r.push(l.data.user);case 10:s++,e.next=5;break;case 13:c=t.friendRequests,i=[],o=0;case 16:if(!(o<c.length)){e.next=24;break}return e.next=19,L.post("/user",{id:c[o]});case 19:"success"===(u=e.sent).data.status&&i.push(u.data.user);case 21:o++,e.next=16;break;case 24:a.setState({friends:Array.from(r)},function(){if(a.props.online_users&&a.props.online_users.length>0){var e=a.props.online_users;a.updateOnlineFriends(e)}}),a.setState({friendRequests:Array.from(i)}),a.setState({isLoaded:!0});case 27:case"end":return e.stop()}},e)})),a.updateOnlineFriends=function(e){if(a.state.friends&&a.state.friends.length>0){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(e[n].user_id);for(var r=[],s=[],l=0;l<a.state.friends.length;l++)a.state.friends[l]&&(t.includes(a.state.friends[l]._id)?r.push(a.state.friends[l]):s.push(a.state.friends[l]));a.setState({online_friends:r}),a.setState({offline_friends:s})}},a.onAccordionClick=function(){var e=document.getElementById("accordion1");e&&e.classList.toggle("active");var t=document.getElementById("friend_requests_panel");t&&("block"===t.style.display?t.style.display="none":t.style.display="block")},a.state={friends:[],friendRequests:[],isLoaded:!1,user:null,online_friends:[],offline_friends:[]},a.childSetFriendsAndRequest=a.childSetFriendsAndRequest.bind(Object(M.a)(Object(M.a)(a))),a}return Object(b.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.getUser()}},{key:"componentWillUnmount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){if(e.online_users&&e.online_users.length>0){var t=e.online_users;this.updateOnlineFriends(t)}}},{key:"render",value:function(){var e=this,t="",a="",n="",s="",l="";if(this.state.isLoaded){if(this.state.friends)if(0===this.state.friends.length)n=r.a.createElement("div",null,"You have no friend yet. Go to search page and search for users.");else{var c=0;this.state.online_friends&&(c=this.state.online_friends.length);var i=r.a.createElement("h2",null,"Online Friends (",c,")");t=this.state.online_friends.map(function(e,t){return r.a.createElement("div",{key:t},r.a.createElement(o.b,{to:"/chat/"+e._id},r.a.createElement(D,{user:e})))});var u=0;this.state.offline_friends&&(u=this.state.offline_friends.length);var d=r.a.createElement("h2",{style:{color:"#ACACAC"}},"Offline Friends (",u,")");a=this.state.offline_friends.map(function(e,t){return r.a.createElement("div",{key:t},r.a.createElement(o.b,{to:"/chat/"+e._id},r.a.createElement(D,{isOffline:!0,user:e})))}),n=r.a.createElement("div",null,i,t,r.a.createElement("hr",null),d,a)}return this.state.friendRequests&&(l=0===(s=this.state.friendRequests).length?r.a.createElement("div",null,"You have no friend requests."):s.map(function(t,a){return r.a.createElement("div",{key:a},r.a.createElement(R,{childSetFriendsAndRequest:e.childSetFriendsAndRequest,user:t}))})),r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("h1",null,"Friends"),r.a.createElement("button",{className:"accordion",id:"accordion1",onClick:this.onAccordionClick},r.a.createElement(T.a,null,r.a.createElement(z.a,{xs:11},r.a.createElement("h4",null,"Friend Requests (",s.length,")")),r.a.createElement(z.a,{xs:1},r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"30px"}},r.a.createElement(F.a,null))))),r.a.createElement("div",{className:"panel",id:"friend_requests_panel"},l),r.a.createElement("hr",null),n)}return r.a.createElement("div",null,"Loading...")}}]),t}(n.Component),$=a(38),Q=a(42),J=a(297),W=a(103),V=a.n(W),G=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).handleChange=function(e){var t=e.target;a.setState(function(e){return Object(Q.a)({},e,Object($.a)({},t.id,t.value))})},a.loadFriend=Object(m.a)(d.a.mark(function e(){var t,n,r,s,l,c,i,o,u;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("userId"),n=a.props.match.params.id,r=[],e.next=5,L.post("/user",{id:t});case 5:if("success"===(s=e.sent).data.status&&(r=s.data.user.friends),r.includes(n)){e.next=9;break}return e.abrupt("return");case 9:return e.prev=9,e.next=12,L.post("/user",{id:n});case 12:if("success"!==(l=e.sent).data.status){e.next=20;break}return a.setState({friend:l.data.user}),a.setState({isFriend:!0}),e.next=18,L.post("/getConversation",{userID:t,friendID:n});case 18:"success"===(c=e.sent).data.status&&(i=c.data.conv_id,o=c.data.messages,a.setState({conversation_id:i},function(){a.connectToSocket()}),a.setState({messages:o}),(u=document.getElementById("dialog"))&&(u.scrollTop=u.scrollHeight));case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(9),console.log(e.t0);case 25:case"end":return e.stop()}},e,null,[[9,22]])})),a.onSendClick=Object(m.a)(d.a.mark(function e(){var t,n,r,s,l;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=localStorage.getItem("userId"),n=a.state.message_to_send,r=a.state.conversation_id,""===n){e.next=9;break}return n=t+":"+n,e.next=7,L.post("/sendMessage",{conversation_id:r,message:n});case 7:"success"===(s=e.sent).data.status&&(l=s.data.messages,a.setState({messages:l}),a.setState({message_to_send:""}),a.state.socket&&a.state.socket.emit("chat",{conversation_id:r}));case 9:case"end":return e.stop()}},e)})),a.connectToSocket=Object(m.a)(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:null==a.state.socket&&(t=P.url.server,n=V()(t,{withCredentials:!0,extraHeaders:{"my-custom-header":"abcd"}}),a.setState({socket:n},function(){a.state.socket&&a.state.conversation_id&&a.state.socket.emit("joinRoom",{room:a.state.conversation_id}),a.state.socket&&a.state.conversation_id&&a.state.socket.on("chat",function(){var e=Object(m.a)(d.a.mark(function e(t){var n,r,s;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("from socket:",t),e.next=3,L.post("/getMessages",{conversation_id:t});case 3:"success"===(n=e.sent).data.status&&(r=n.data.messages,a.setState({messages:r}),(s=document.getElementById("dialog"))&&(s.scrollTop=s.scrollHeight));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}));case 1:case"end":return e.stop()}},e)})),a.onKeyUp=function(e){e.preventDefault(),"Enter"===e.key&&a.onSendClick()},a.state={friend:null,isFriend:!1,conversation_id:"",messages:[],message_to_send:"",socket:null},a}return Object(b.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.loadFriend()}},{key:"componentWillUnmount",value:function(){this.state.socket&&this.state.socket.close()}},{key:"render",value:function(){var e=this,t="",a="";if(this.state.friend&&(t=this.state.friend._id,a=this.state.friend),!this.state.isFriend)return r.a.createElement("div",null,"You can't chat with a person that is not your friend.");var n="";return this.state.messages&&(n=this.state.messages.map(function(t,a){var n=t.substring(0,t.indexOf(":")),s=t.substring(t.indexOf(":")+1,t.length),l="";return l=n===e.props.match.params.id?"friend-dialog":"self-dialog",r.a.createElement("div",{key:a},r.a.createElement("div",{className:l},s))})),r.a.createElement("div",null,r.a.createElement(o.b,{to:"/profile/"+t,key:t},r.a.createElement(D,{user:a})),r.a.createElement("div",{className:"dialog-area",id:"dialog"},n),r.a.createElement("div",{className:"input-message",id:"input_area"},r.a.createElement("div",{style:{verticalAlign:"middle",display:"table-cell"}},"Your Message: "),r.a.createElement(J.a,{onKeyUp:this.onKeyUp,value:this.state.message_to_send,id:"message_to_send",onChange:this.handleChange,style:{width:"90%"},placeholder:"Aa",variant:"outlined"}),r.a.createElement("div",{style:{verticalAlign:"middle",display:"table-cell"}},r.a.createElement(B.a,{style:{fontSize:"16px"},onClick:this.onSendClick,className:"nav-btn"},"Send"))))}}]),t}(n.Component),Y=a(19),K=a(36),X=a(114),Z=a(31),ee=a.n(Z),te=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).handleChange=function(e){var t=e.target;a.setState(function(e){return Object(Q.a)({},e,Object($.a)({},t.id,t.value))})},a.handleSubmit=function(){var e=Object(m.a)(d.a.mark(function e(t){var n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!(n=a.state.modalInputName)){e.next=19;break}return console.log(a.props.musicListId),console.log(n),a.props.updateMusicList({variables:{musicListId:a.props.musicListId,musicListNewName:n,isPublic:a.props.isPublic}}),e.prev=6,e.next=9,L.get("/user/musicLists/"+a.props.userId);case 9:"success"===(r=e.sent).data.status&&(console.log("success"),console.log("musiclists is",r.data.musicLists),(0,a.props.handler)(r.data.musicLists)),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),console.log(e.t0);case 16:a.props.handleClose(),e.next=20;break;case 19:alert("cannot be empty");case 20:case"end":return e.stop()}},e,null,[[6,13]])}));return function(t){return e.apply(this,arguments)}}(),a.state={modalInputName:""},a}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"modal d-block",style:{visibility:this.props.show?"visible":"hidden"}},r.a.createElement("div",{className:"modal-content"},r.a.createElement("span",{onClick:this.props.handleClose,className:"close"},"\xd7"),r.a.createElement(H.a,null,r.a.createElement("h2",null,"Edit Playlist Name:"),r.a.createElement("div",{className:"form-group"},r.a.createElement(J.a,{id:"modalInputName",size:"small",type:"name",placeholder:"new name",variant:"outlined",onChange:this.handleChange})),r.a.createElement(T.a,null,r.a.createElement(B.a,{className:"search-btn",onClick:function(t){return e.handleSubmit(t)}},"Save"),r.a.createElement(B.a,{className:"modal-close cancel-btn",onClick:this.props.handleClose},"Cancel")))))}}]),t}(n.Component);function ae(){var e=Object(K.a)(["\n    mutation removeMusicList($playlistId: String!\n        ) {\n            removeMusicList(id: $playlistId){\n                _id\n            }\n    }\n"]);return ae=function(){return e},e}function ne(){var e=Object(K.a)(["\n    mutation updateMusicList(\n        $musicListId: String!\n        $musicListNewName: String!\n        $isPublic: Boolean!\n    ) {\n    updateMusicList(\n        id: $musicListId\n        musicListName: $musicListNewName\n        isPublic: $isPublic\n    ){\n      _id\n    }\n  }\n"]);return ne=function(){return e},e}function re(){var e=Object(K.a)(["\n    mutation removePlaylist($userId: String!\n                            $playlistId: String!\n        ) {\n        removePlaylist(\n            id: $userId\n            playlistId: $playlistId\n        ){\n            _id\n        }\n    }\n"]);return re=function(){return e},e}var se=ee()(re()),le=ee()(ne()),ce=ee()(ae()),ie=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).closeModal=function(){document.getElementById("main_modal").style.display="none"},a.onDeleteClick=function(e,t,n){if(localStorage.getItem("isSignedIn")){var s=document.getElementById("main_modal");if(s)s.style.display="block",(0,a.props.updateModalContentHandler)(r.a.createElement("div",null,r.a.createElement("h3",null,'Are you sure to delete the playlist "',a.props.musicListName,'"?'),r.a.createElement(B.a,{className:"search-btn",onClick:function(e){return a.onDeleteConfirm(e,t,n)}},"Confirm"),r.a.createElement(B.a,{className:"cancel-btn",onClick:a.closeModal},"Cancel")))}else alert("Please sign in first!")},a.onDeleteConfirm=function(){var e=Object(m.a)(d.a.mark(function e(t,n,r){var s;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),console.log("click to remove"),console.log(a.props.userId),console.log(a.props.musicListId),n({variables:{userId:a.props.userId,playlistId:a.props.musicListId}}),r({variables:{playlistId:a.props.musicListId}}),e.prev=6,e.next=9,L.get("/user/musicLists/"+a.props.userId);case 9:"success"===(s=e.sent).data.status&&(console.log("success"),console.log("musiclists is",s.data.musicLists),(0,a.props.handler)(s.data.musicLists)),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),console.log(e.t0);case 16:a.closeModal();case 17:case"end":return e.stop()}},e,null,[[6,13]])}));return function(t,a,n){return e.apply(this,arguments)}}(),a.handleEditOnClick=function(){console.log("click to edit"),a.setState({popupDisplay:!0})},a.handleCloseOnClick=function(){console.log("click to close"),a.setState({popupDisplay:!1})},a.state={popupDisplay:!1},a}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this,t=this.props.musicListId,a="/playlist/"+t,n=r.a.createElement(i.b,{mutation:se},function(t,a){a.loading,a.error;return r.a.createElement(i.b,{mutation:ce},function(a,n){n.loading,n.error;return r.a.createElement(F.d,{onClick:function(n){return e.onDeleteClick(n,t,a)}})})}),s=null;return this.props.userId===this.props.ownerId&&(s=r.a.createElement(X.a,{onClick:this.handleEditOnClick})),r.a.createElement(T.a,null,r.a.createElement(o.b,{to:a},r.a.createElement("div",{className:"playlist-card"},r.a.createElement("div",null,this.props.musicListName))),r.a.createElement("div",{style:{cursor:"pointer"}},r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"35px"}},s,n)),r.a.createElement(i.b,{mutation:le},function(a,n){n.loading,n.error;return r.a.createElement(te,{updateMusicList:a,musicListId:t,show:e.state.popupDisplay,userId:e.props.userId,ownerId:e.props.ownerId,handler:e.props.handler,handleClose:e.handleCloseOnClick,isPublic:e.props.isPublic})}))}}]),t}(n.Component);function oe(){var e=Object(K.a)(["\n    query musicList($musicListId: String) {\n        musicList(id: $musicListId) {\n            musicListName\n            owner{\n                _id\n            }\n            isPublic\n        }\n    }\n"]);return oe=function(){return e},e}function ue(){var e=Object(K.a)(["\n    query user($userId: String) {\n        user(id: $userId) {\n            musicLists{\n                _id\n            }\n        }\n    }\n"]);return ue=function(){return e},e}ee()(ue()),ee()(oe());function de(e){var t=r.a.useState(null),a=Object(Y.a)(t,2),s=a[0],l=a[1],c=r.a.useState(""),i=Object(Y.a)(c,2),o=i[0],u=i[1],p=localStorage.getItem("userId"),f=function(){var e=Object(m.a)(d.a.mark(function e(t){var a,n,r,s;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("hangler triggered"),a=[],n=0;case 3:if(!(n<t.length)){e.next=12;break}return r=t[n],e.next=7,L.get("/musicList/"+r);case 7:"success"===(s=e.sent).data.status?a.push(s.data.musicList):console.log("error searching playlist",r);case 9:n++,e.next=3;break;case 12:l(Array.from(a));case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();Object(n.useEffect)(function(){function e(){return(e=Object(m.a)(d.a.mark(function e(){var t,a,n,r,s;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!p){e.next=27;break}return e.prev=1,e.next=4,L.get("/user/musicLists/"+p);case 4:if("success"!==(t=e.sent).data.status){e.next=22;break}console.log("success"),console.log("musiclists is",t.data.musicLists),a=[],n=0;case 10:if(!(n<t.data.musicLists.length)){e.next=19;break}return r=t.data.musicLists[n],e.next=14,L.get("/musicList/"+r);case 14:"success"===(s=e.sent).data.status?a.push(s.data.musicList):console.log("error searching playlist",r);case 16:n++,e.next=10;break;case 19:l(Array.from(a)),e.next=22;break;case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(1),console.log(e.t0);case 27:case"end":return e.stop()}},e,null,[[1,24]])}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[]);if(p||e.history.push("/signin"),s){var g="";return g=s.length>0?s.filter(function(e){return e.musicListName.toLowerCase().includes(o.toLowerCase())}).map(function(t){return r.a.createElement(ie,{key:t._id,isPublic:t.isPublic,userId:p,musicListId:t._id,musicListName:t.musicListName,ownerId:t.owner,updateModalContentHandler:e.updateModalContentHandler,handler:f})}):r.a.createElement("div",null,'You don\'t have any playlist. Click "Create Playlist" to make a new one.'),r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("h1",null,"All Playlists"),r.a.createElement("div",{style:{padding:"5px"}},r.a.createElement(J.a,{size:"small",placeholder:"Filter...",variant:"outlined",id:"filter",onChange:function(e){var t=e.target;u(t.value)}})),g)}return r.a.createElement("div",null,"Loading...")}var me=a(20),pe=a(129);function fe(){var e=Object(K.a)(["\n    mutation AddNewPlaylist(\n        $id: String!,\n        $playlistId: String!,\n        ) {\n        addNewPlaylist(\n            id: $id,\n            playlistId: $playlistId\n            ) {\n            _id\n        }\n    }\n"]);return fe=function(){return e},e}var ge=ee()(fe()),he=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).handleChange=function(e){var t=e.target;a.setState(function(e){return Object(Q.a)({},e,Object($.a)({},t.id,t.value))})},a.selectButtons=function(){if(localStorage.getItem("isSignedIn")){var e=localStorage.getItem("userId");return r.a.createElement("div",null,r.a.createElement(o.b,{to:"/profile/"+e},r.a.createElement(B.a,{className:"nav-btn",size:"lg"},r.a.createElement(T.a,null,r.a.createElement(z.a,{xs:2},r.a.createElement(q.b.Provider,{value:{size:"30px"}},r.a.createElement(me.i,{style:{paddingBottom:"5px"}}))),r.a.createElement(z.a,{xs:10},"My Profile")))),r.a.createElement(o.b,{to:"/friends"},r.a.createElement(B.a,{className:"nav-btn",size:"lg"},r.a.createElement(T.a,null,r.a.createElement(z.a,{xs:2},r.a.createElement(q.b.Provider,{value:{size:"30px"}},r.a.createElement(me.h,{style:{paddingBottom:"5px"}}))),r.a.createElement(z.a,{xs:10},"Friends")))),r.a.createElement(o.b,{to:"/playlists"},r.a.createElement(B.a,{className:"nav-btn",size:"lg"},r.a.createElement(T.a,null,r.a.createElement(z.a,{xs:2},r.a.createElement(q.b.Provider,{value:{size:"30px"}},r.a.createElement(me.n,{style:{paddingBottom:"5px"}}))),r.a.createElement(z.a,{xs:10},"Playlists")))),r.a.createElement(i.b,{mutation:ge},function(e,t){t.loading,t.error;return r.a.createElement(B.a,{className:"nav-btn",size:"lg",onClick:function(t){return a.openModal(t,e)}},r.a.createElement(T.a,null,r.a.createElement(z.a,{xs:2},r.a.createElement(q.b.Provider,{value:{size:"30px"}},r.a.createElement(me.l,{style:{paddingBottom:"5px"}}))),r.a.createElement(z.a,{xs:10},"Create Playlist")))}),r.a.createElement(B.a,{className:"nav-btn",size:"lg",onClick:function(){a.props.signedOut()}},r.a.createElement(T.a,null,r.a.createElement(z.a,{xs:2},r.a.createElement(q.b.Provider,{value:{size:"30px"}},r.a.createElement(pe.b,{style:{paddingBottom:"5px"}}))),r.a.createElement(z.a,{xs:10},"Sign Out"))))}return r.a.createElement("div",null,r.a.createElement(o.b,{to:"/signin"},r.a.createElement(B.a,{className:"nav-btn",size:"lg"},r.a.createElement(T.a,null,r.a.createElement(z.a,{xs:2},r.a.createElement(q.b.Provider,{value:{size:"30px"}},r.a.createElement(pe.a,{style:{paddingBottom:"5px"}}))),r.a.createElement(z.a,{xs:10},"Sign In")))),r.a.createElement(o.b,{to:"/signup"},r.a.createElement(B.a,{className:"nav-btn",size:"lg"},r.a.createElement(T.a,null,r.a.createElement(z.a,{xs:2},r.a.createElement(q.b.Provider,{value:{size:"30px"}},r.a.createElement(me.a,{style:{paddingBottom:"5px"}}))),r.a.createElement(z.a,{xs:10},"Sign Up")))))},a.setMusicListNameHandler=function(e,t){console.log(a.state.musicListName);var n=a.state.musicListName;""!==n&&a.handleCreateNewList(t,n)},a.openModal=function(e,t){if(localStorage.getItem("isSignedIn")){var n=document.getElementById("main_modal");if(n)n.style.display="block",(0,a.props.updateModalContentHandler)(r.a.createElement("div",null,r.a.createElement("h2",null,"Create New Playlist"),r.a.createElement("div",{style:{padding:"5px"}},r.a.createElement(J.a,{id:"musicListName",size:"small",placeholder:"New List",variant:"outlined",onChange:a.handleChange})),r.a.createElement(B.a,{className:"search-btn",onClick:function(e){return a.setMusicListNameHandler(e,t)}},"Create"),r.a.createElement(B.a,{className:"cancel-btn",onClick:a.closeModal},"Cancel")))}else alert("Please sign in first!")},a.closeModal=function(){document.getElementById("main_modal").style.display="none"},a.handleCreateNewList=function(){var e=Object(m.a)(d.a.mark(function e(t,n){var r,s;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=localStorage.getItem("userId"),e.next=4,L.post("/createMusicList",{userId:r,musicListName:n});case 4:"success"===(s=e.sent).data.status?(t({variables:{id:r,playlistId:s.data.musicListId}}),a.closeModal(),a.props.history.push("/playlist/"+s.data.musicListId)):alert("Playlist creation failed"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t,a){return e.apply(this,arguments)}}(),a.state={playlist:"",musicListName:""},a}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(o.b,{to:"/"},r.a.createElement(B.a,{className:"nav-btn",size:"lg"},r.a.createElement(T.a,null,r.a.createElement(z.a,{xs:2},r.a.createElement(q.b.Provider,{value:{size:"30px"}},r.a.createElement(me.c,{style:{paddingBottom:"5px"}}))),r.a.createElement(z.a,{xs:10},"Home")))),r.a.createElement(o.b,{to:"/search"},r.a.createElement(B.a,{className:"nav-btn",size:"lg"},r.a.createElement(T.a,null,r.a.createElement(z.a,{xs:2},r.a.createElement(q.b.Provider,{value:{size:"30px"}},r.a.createElement(me.p,{style:{paddingBottom:"5px"}}))),r.a.createElement(z.a,{xs:10},"Search")))),this.selectButtons())}}]),t}(n.Component),be=Object(v.f)(he),ve=a(301),Ee=a(290),ke=a(167),ye=a.n(ke),xe=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).tick=function(){a.state.isPlaying&&a.setState({progress:a.state.audioTag.currentTime})},a.onNextSong=Object(m.a)(d.a.mark(function e(){var t,n,r,s;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=localStorage.getItem("queue"),t=JSON.parse(t)){e.next=4;break}return e.abrupt("return");case 4:if(a.state.audioTag.pause(),!a.state.track_data){e.next=20;break}n=0,r=!1,n=0;case 9:if(!(n<t.length)){e.next=16;break}if(t[n].URI!==a.state.track_data.id){e.next=13;break}return r=!0,e.abrupt("break",16);case 13:n++,e.next=9;break;case 16:r?a.state.isShuffle?n=Math.floor(Math.random()*t.length):n===t.length-1?n=0:n+=1:n=0,n<t.length&&(s=t[n],a.loadSongAndplay(s,n)),e.next=21;break;case 20:a.onPlayClick();case 21:case"end":return e.stop()}},e)})),a.onPrevSong=Object(m.a)(d.a.mark(function e(){var t,n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.state.currentIndex,t=localStorage.getItem("queue"),t=JSON.parse(t)){e.next=5;break}return e.abrupt("return");case 5:if(!a.state.track_data){e.next=17;break}n=0,n=0;case 8:if(!(n<t.length)){e.next=14;break}if(t[n].URI!==a.state.track_data.id){e.next=11;break}return e.abrupt("break",14);case 11:n++,e.next=8;break;case 14:0!=n&&(r=t[n-=1],a.loadSongAndplay(r,n)),e.next=18;break;case 17:a.onPlayClick();case 18:case"end":return e.stop()}},e)})),a.loadQueueIndexAndPlay=function(e){var t=localStorage.getItem("queue");(t=JSON.parse(t))&&(e>=t.length||a.loadSongAndplay(t[e],e))},a.loadSongAndplay=function(){var e=Object(m.a)(d.a.mark(function e(t,n){var r,s,l,c,i,o,u;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=localStorage.getItem("userId"),t){e.next=3;break}return e.abrupt("return");case 3:return s=t.URI,e.next=6,L.post("/getSongAudio",{URI:s});case 6:if("success"!==(l=e.sent).data.status){e.next=16;break}if(!r){e.next=13;break}return e.next=11,L.post("/updateNowPlaying",{id:r,musicID:t._id});case 11:"success"===(c=e.sent).data.status&&(0,a.props.updateNowPlaying)(c.data.user.nowListening);case 13:l.data.track.preview_url?((i=a.state.interval)||(i=setInterval(a.tick,100)),a.setState({url:l.data.track.preview_url,track_data:l.data.track,isPlaying:!0,progress:0,currentIndex:n,interval:i}),a.state.audioTag.src=l.data.track.preview_url,a.state.audioTag.play()):((o=a.state.interval)||(o=setInterval(a.tick,100)),a.setState({track_data:l.data.track,isPlaying:!0,progress:0,currentIndex:n,interval:o}),a.state.audioTag.src=ye.a,a.state.audioTag.play(),(u=document.getElementById("no_song_toast")).className="show",setTimeout(function(){u.className=u.className.replace("show","")},3e3)),e.next=17;break;case 16:console.log("errored");case 17:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.changeVolumn=function(e){a.state.audioTag&&(a.state.audioTag.volume=e/100,a.setState({volume:e}))},a.handleChange=function(e,t){a.state.audioTag&&(a.state.audioTag.volume=t/100,a.setState({volume:t}))},a.handleAudioSlider=function(e,t){a.state.audioTag&&(a.state.audioTag.currentTime=t/100*30,a.setState({progress:t/100*30}))},a.onPlayClick=Object(m.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=localStorage.getItem("queue"),t=JSON.parse(t)){e.next=4;break}return e.abrupt("return");case 4:a.state.track_data?a.state.audioTag&&(a.state.isPlaying?(a.state.audioTag.pause(),clearInterval(a.state.interval),a.setState({isPlaying:!a.state.isPlaying,interval:null})):(a.state.audioTag.play(),a.setState({interval:setInterval(a.tick,100),isPlaying:!a.state.isPlaying}))):t.length>0&&a.loadSongAndplay(t[0],0);case 5:case"end":return e.stop()}},e)})),a.onVolumeClick=function(){a.state.audioTag&&(a.state.isMute?(a.state.audioTag.muted=!1,a.setState({isMute:!a.state.isMute})):(a.state.audioTag.muted=!0,a.setState({isMute:!a.state.isMute})))},a.onShuffleClick=function(){a.state.audioTag&&(a.state.isShuffle?a.setState({isShuffle:!a.state.isShuffle}):(a.setState({isShuffle:!a.state.isShuffle}),a.setState({isLoop:!1})))},a.onLoopClick=function(){a.state.audioTag&&(a.state.isLoop?(a.state.audioTag.muted=!1,a.state.audioTag.loop=!1,a.setState({isLoop:!a.state.isLoop})):(a.state.audioTag.loop=!0,a.setState({isLoop:!a.state.isLoop}),a.setState({isShuffle:!1})))},a.checkSignIn=function(){localStorage.getItem("isSignedIn")||alert("Please sign in to use this function.")},a.state={volume:20,track_url:"",track_data:null,progress:0,duration:0,isPlaying:!1,audioTag:new Audio,isMute:!1,isLoop:!1,isShuffle:!1,currentIndex:0,interval:null},a.state.audioTag.addEventListener("ended",function(e){a.onNextSong()}),a.changeVolumn(20),a}return Object(b.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.props.onRef(this)}},{key:"componentWillUnmount",value:function(){this.props.onRef(void 0)}},{key:"render",value:function(){var e=r.a.createElement(me.j,null);this.state.isPlaying&&(e=r.a.createElement(me.f,null));var t=r.a.createElement(me.u,null);this.state.isMute&&(t=r.a.createElement(me.t,null));var a=r.a.createElement(q.b.Provider,{value:{color:"#ADADAD",size:"40px"}},r.a.createElement(me.q,null));this.state.isShuffle&&(a=r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"40px"}},r.a.createElement(me.q,null)));var n=r.a.createElement(q.b.Provider,{value:{color:"#ADADAD",size:"40px"}},r.a.createElement(me.o,null));this.state.isLoop&&(n=r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"40px"}},r.a.createElement(me.o,null)));var s="";s=localStorage.getItem("isSignedIn")?{pathname:"/queue"}:"";var l=(this.state.progress/60<10?"0":"")+Math.floor(this.state.progress/60)+":"+(this.state.progress%60<10?"0":"")+Math.floor(this.state.progress%60);return r.a.createElement("div",{className:"secondary-bg",style:{height:"20vh",zIndex:"10",color:"#ed4e85"}},r.a.createElement(H.a,null,r.a.createElement(T.a,null,r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"40px"}},r.a.createElement(z.a,{xs:2,className:"content-center"},r.a.createElement(o.b,{to:s,onClick:this.checkSignIn,style:{color:"#ed4e85"}},r.a.createElement(me.m,null),"Queue")),r.a.createElement(z.a,{xs:2,className:"content-center"},r.a.createElement("div",null,this.state.track_data?this.state.track_data.name:"none")),r.a.createElement(z.a,{xs:4,className:"content-center"},r.a.createElement(Ee.a,{"aria-label":"prev",onClick:this.onPrevSong},r.a.createElement(me.s,null)),r.a.createElement(Ee.a,{"aria-label":"play",onClick:this.onPlayClick},e),r.a.createElement(Ee.a,{"aria-label":"next",onClick:this.onNextSong},r.a.createElement(me.r,null))),r.a.createElement(z.a,{xs:4,className:"content-center"},r.a.createElement(Ee.a,{"aria-label":"shuffle",onClick:this.onShuffleClick},a),r.a.createElement(Ee.a,{"aria-label":"loop",onClick:this.onLoopClick},n),r.a.createElement(Ee.a,{"aria-label":"volume",onClick:this.onVolumeClick},t),r.a.createElement(ve.a,{id:"volume",value:this.state.volume,onChange:this.handleChange,className:"volume-slider","aria-labelledby":"continuous-slider"})))),r.a.createElement(T.a,null,r.a.createElement(z.a,{className:"content-center"},r.a.createElement("span",{style:{margin:"10px"}},l),r.a.createElement(ve.a,{className:"audio-slider","aria-labelledby":"continuous-slider",value:this.state.progress/30*100,onChange:this.handleAudioSlider}),r.a.createElement("span",{style:{margin:"10px"}},"00:30")))))}}]),t}(n.Component),Se=(n.Component,a(57)),Ce=a(169),Oe=a(302),Ie=["Add to Queue","Add to Playlist","Share","Remove from this Playlist"];function we(e){var t=e.song,a=null,n=localStorage.getItem("userId"),s=r.a.useState(null),l=Object(Y.a)(s,2),c=l[0],i=l[1],o=r.a.useState(1),u=Object(Y.a)(o,2),p=(u[0],u[1]),f=function(){var e=Object(m.a)(d.a.mark(function e(t,a,n){var r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(a+" "+n),e.prev=1,e.next=4,L.post("/addSong",{musicListID:n,songID:a});case 4:"success"===e.sent.data.status&&(r=document.getElementById("modal"))&&(r.style.display="none"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:case"end":return e.stop()}},e,null,[[1,8]])}));return function(t,a,n){return e.apply(this,arguments)}}(),g=function(){var s=Object(m.a)(d.a.mark(function s(l,c){var o,u,m,g,h,b,v,E,k,y,x,S;return d.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(p(c),i(null),o="",0===c?o="add_queue":1===c?o="add_playlist":2===c?o="share":3===c&&(o="remove"),"add_queue"!==o){s.next=22;break}return s.prev=5,u=(u=localStorage.getItem("queue"))?JSON.parse(u):[],console.log(t._id),m=t._id,s.next=12,L.get("/music/"+m);case 12:g=s.sent,console.log(g.data.music),"success"==g.data.status&&(u.length>0?(h=u.map(function(e){return e._id===g.data.music._id}).reduce(function(e,t){return e||t}),console.log(h),h||(u.push(g.data.music),localStorage.setItem("queue",JSON.stringify(u)))):(u.push(g.data.music),localStorage.setItem("queue",JSON.stringify(u)))),s.next=20;break;case 17:s.prev=17,s.t0=s.catch(5),console.log(s.t0);case 20:s.next=71;break;case 22:if("add_like"!==o){s.next=25;break}s.next=71;break;case 25:if("add_playlist"!==o){s.next=56;break}if(!t||!n){s.next=54;break}if(!(b=document.getElementById("modal"))){s.next=54;break}return b.style.display="block",v=e.updateModalContentHandler,s.prev=31,s.next=34,L.get("/user/musicLists/"+n);case 34:if("success"!==(E=s.sent).data.status){s.next=49;break}k=E.data.musicLists,y=[],x=0;case 39:if(!(x<k.length)){s.next=47;break}return s.next=42,L.get("/musicList/"+k[x]);case 42:"success"===(S=s.sent).data.status&&y.push(S.data.musicList);case 44:x++,s.next=39;break;case 47:a=y.map(function(e,a){return r.a.createElement("div",{onClick:function(a){return f(a,t._id,e._id)},className:"playlist-card"},r.a.createElement("div",null,e.musicListName))}),v(a);case 49:s.next=54;break;case 51:s.prev=51,s.t1=s.catch(31),console.log(s.t1);case 54:s.next=71;break;case 56:if("share"!==o){s.next=59;break}s.next=71;break;case 59:if("remove"!==o){s.next=71;break}if(!t){s.next=71;break}return s.prev=61,s.next=64,L.post("/removeSong",{musicListId:e.musicListId,songID:t._id});case 64:"success"===s.sent.data.status&&(0,e.updatePlaylist)(),s.next=71;break;case 68:s.prev=68,s.t2=s.catch(61),console.log(s.t2);case 71:case"end":return s.stop()}},s,null,[[5,17],[31,51],[61,68]])}));return function(e,t){return s.apply(this,arguments)}}();if(t){var h=0,b=0;t.length&&((h=Math.floor(t.length/60))<10&&(h="0"+h),(b=Math.floor(t.length%60))<10&&(b="0"+b));var v="N/A";t.artist&&(v=t.artist);var E="N/A";t.album&&(E=t.album);var k="N/A";t.musicName&&(k=t.musicName);var y="";return e.reorder_mode&&(y=r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"25px"}},r.a.createElement(me.b,null))),r.a.createElement("div",null,r.a.createElement(H.a,null,r.a.createElement(T.a,{className:"border-bottom-accent"},r.a.createElement(z.a,{xs:1},y),r.a.createElement(z.a,{xs:3},k),r.a.createElement(z.a,{xs:2},v),r.a.createElement(z.a,{xs:3},E),r.a.createElement(z.a,{xs:1},h,":",b),r.a.createElement(z.a,{xs:1},r.a.createElement(Ee.a,{"aria-label":"play-song",onClick:function(t){return function(){var t=e.index;(0,e.onSongCardClick)(t)}()}},r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"30px"}},r.a.createElement(me.k,null)))),r.a.createElement(z.a,{xs:1},r.a.createElement(Ee.a,{"aria-label":"more","aria-controls":"menu","aria-haspopup":"true",onClick:function(e){i(e.currentTarget)}},r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"30px"}},r.a.createElement(me.d,null))),r.a.createElement(Ce.a,{id:"menu",anchorEl:c,keepMounted:!0,open:Boolean(c),onClose:function(){i(null)}},Ie.map(function(e,t){return r.a.createElement(Oe.a,{key:e,onClick:function(e){return g(e,t)}},e)}))))))}return r.a.createElement("div",null,"error")}var Ne=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).onTitleClickHandler=function(){(0,a.props.onTitleClickHandler)(),a.setState({title_ascending:!a.state.title_ascending}),a.setState({artist_ascending:!0}),a.setState({album_ascending:!0}),a.setState({time_ascending:!0})},a.onArtistClickHandler=function(){(0,a.props.onArtistClickHandler)(),a.setState({title_ascending:!0}),a.setState({artist_ascending:!a.state.artist_ascending}),a.setState({album_ascending:!0}),a.setState({time_ascending:!0})},a.onAlbumClickHandler=function(){(0,a.props.onAlbumClickHandler)(),a.setState({title_ascending:!0}),a.setState({artist_ascending:!0}),a.setState({album_ascending:!a.state.album_ascending}),a.setState({time_ascending:!0})},a.onTimeClickHandler=function(){(0,a.props.onTimeClickHandler)(),a.setState({title_ascending:!0}),a.setState({artist_ascending:!0}),a.setState({album_ascending:!0}),a.setState({time_ascending:!a.state.time_ascending})},a.placeholder=function(){},a.state={title_ascending:!0,artist_ascending:!0,album_ascending:!0,time_ascending:!0},a}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e="",t="",a="",n="",s="";this.props.reorder_mode?(e="reorder-mode-title",t=this.onTitleClickHandler,a=this.onArtistClickHandler,n=this.onAlbumClickHandler,s=this.onTimeClickHandler):(e="non-reorder-mode-title",t=this.placeholder,a=this.placeholder,n=this.placeholder,s=this.placeholder);var l="",c="",i="",o="";return this.props.reorder_mode&&(l=this.state.title_ascending?r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"15px"}},r.a.createElement(F.b,null)):r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"15px"}},r.a.createElement(F.a,null)),c=this.state.artist_ascending?r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"15px"}},r.a.createElement(F.b,null)):r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"15px"}},r.a.createElement(F.a,null)),i=this.state.album_ascending?r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"15px"}},r.a.createElement(F.b,null)):r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"15px"}},r.a.createElement(F.a,null)),o=this.state.time_ascending?r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"15px"}},r.a.createElement(F.b,null)):r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"15px"}},r.a.createElement(F.a,null))),r.a.createElement("div",null,r.a.createElement(H.a,null,r.a.createElement(T.a,{className:"border-bottom-accent"},r.a.createElement(z.a,{xs:1}),r.a.createElement(z.a,{xs:3,className:e,onClick:t},r.a.createElement("span",null,"Title")," ",l),r.a.createElement(z.a,{xs:2,className:e,onClick:a},r.a.createElement("span",null,"Artist")," ",c),r.a.createElement(z.a,{xs:3,className:e,onClick:n},r.a.createElement("span",null,"Album")," ",i),r.a.createElement(z.a,{xs:2,className:e,onClick:s},r.a.createElement("span",null,"Time")," ",o),r.a.createElement(z.a,{xs:1},"Options"))))}}]),t}(n.Component),_e=a(298),je=a(88),Pe=a.n(je);function Le(){var e=Object(K.a)(["\n    mutation removeMusicList($playlistId: String!\n        ) {\n            removeMusicList(id: $playlistId){\n                _id\n            }\n    }\n"]);return Le=function(){return e},e}function Ae(){var e=Object(K.a)(["\n    mutation removePlaylist($userId: String!\n                            $playlistId: String!\n        ) {\n        removePlaylist(id: $userId\n                    playlistId: $playlistId){\n                        _id\n                    }\n    }\n"]);return Ae=function(){return e},e}var Me=ee()(Ae()),Te=ee()(Le()),ze=["Make Private","Share"];function He(e){var t=r.a.useState(null),a=Object(Y.a)(t,2),s=a[0],l=a[1],c=r.a.useState(0),u=Object(Y.a)(c,2),p=(u[0],u[1]),f=r.a.useState(null),g=Object(Y.a)(f,2),h=g[0],b=g[1],v=r.a.useState([]),E=Object(Y.a)(v,2),k=E[0],y=E[1],x=r.a.useState(null),S=Object(Y.a)(x,2),C=S[0],O=S[1],I=r.a.useState(!1),N=Object(Y.a)(I,2),_=N[0],j=N[1],P=r.a.useState(0),A=Object(Y.a)(P,2),M=A[0],H=A[1],D=r.a.useState(!0),R=Object(Y.a)(D,2),U=R[0],$=R[1],Q=r.a.useState(!0),J=Object(Y.a)(Q,2),W=J[0],V=J[1],G=r.a.useState(!0),K=Object(Y.a)(G,2),X=K[0],Z=K[1],ee=r.a.useState(!0),te=Object(Y.a)(ee,2),ae=te[0],ne=te[1],re=r.a.useState(null),se=Object(Y.a)(re,2),le=se[0],ce=se[1],ie=r.a.useState(0),oe=Object(Y.a)(ie,2),ue=oe[0],de=oe[1],pe=localStorage.getItem("userId"),fe=function(e){ce(e)},ge=function(t){var a;a=Array.from(k),localStorage.setItem("queue",JSON.stringify(a));var n=e.loadQueueSongsToAudioPlayer;a&&t<a.length&&n(a[t])},he=function(){var t=Object(m.a)(d.a.mark(function t(){var a,n,r,s,l,c,i;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,L.get("/musicList/"+e.match.params.id);case 3:if("success"!==(a=t.sent).data.status){t.next=26;break}b(a.data.musicList),console.log("updatePlaylist",a.data.musicList),n=[],r=0,s=0;case 10:if(!(s<a.data.musicList.musics.length)){t.next=19;break}return l=a.data.musicList.musics[s],t.next=14,L.get("/music/"+l);case 14:"success"===(c=t.sent).data.status?(n.push(c.data.music),r+=c.data.music.length):console.log("error searching song",l);case 16:s++,t.next=10;break;case 19:return y(Array.from(n)),H(r),t.next=23,L.get("/user/"+a.data.musicList.owner);case 23:"success"===(i=t.sent).data.status&&O(i.data.user),console.log("owner",i.data.user);case 26:t.next=31;break;case 28:t.prev=28,t.t0=t.catch(0),console.log(t.t0);case 31:case"end":return t.stop()}},t,null,[[0,28]])}));return function(){return t.apply(this,arguments)}}(),be=function(){var e=Object(m.a)(d.a.mark(function e(t,a,n,r){var s;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(p(a),l(null),"Make Public"!==(s=ze[a])&&"Make Private"!==s){e.next=21;break}if(!r){e.next=18;break}return ze[0]=n?"Make Public":"Make Private",e.prev=6,e.next=9,L.post("/setIsPublic",{id:h._id,isPublic:!n});case 9:"success"===e.sent.data.status&&(console.log("update isPublic success"),he()),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),console.log(e.t0);case 16:e.next=19;break;case 18:alert("you do not own the playlist");case 19:e.next=22;break;case 21:case 22:case"end":return e.stop()}},e,null,[[6,13]])}));return function(t,a,n,r){return e.apply(this,arguments)}}(),ve=function(){var t=Object(m.a)(d.a.mark(function t(a,n,r){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.next=3,n({variables:{userId:pe,playlistId:e.match.params.id}});case 3:return t.next=5,r({variables:{playlistId:e.match.params.id}});case 5:ke(),e.history.push("/playlists");case 7:case"end":return t.stop()}},t)}));return function(e,a,n){return t.apply(this,arguments)}}(),ke=function(){document.getElementById("main_modal").style.display="none"};Object(n.useEffect)(function(){function t(){return(t=Object(m.a)(d.a.mark(function t(){var a,n,r,s,l,c,i;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,de(1),t.next=4,L.get("/musicList/"+e.match.params.id);case 4:if("success"!==(a=t.sent).data.status){t.next=27;break}b(a.data.musicList),n=[],r=0,s=0;case 10:if(!(s<a.data.musicList.musics.length)){t.next=19;break}return l=a.data.musicList.musics[s],t.next=14,L.get("/music/"+l);case 14:"success"===(c=t.sent).data.status?(n.push(c.data.music),r+=c.data.music.length):console.log("error searching song",l);case 16:s++,t.next=10;break;case 19:return y(Array.from(n)),H(r),t.next=23,L.get("/user/"+a.data.musicList.owner);case 23:"success"===(i=t.sent).data.status&&O(i.data.user),t.next=27;break;case 27:t.next=32;break;case 29:t.prev=29,t.t0=t.catch(0),console.log(t.t0);case 32:case"end":return t.stop()}},t,null,[[0,29]])}))).apply(this,arguments)}!function(){t.apply(this,arguments)}()},[]),Object(n.useEffect)(function(){C&&(ze=pe===C._id?["Make Private","Share"]:["Fork","Share"])},[C]),Object(n.useEffect)(function(){function t(){return(t=Object(m.a)(d.a.mark(function t(){var a,n,r,s,l,c,i;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,de(1),t.next=4,L.get("/musicList/"+e.match.params.id);case 4:if("success"!==(a=t.sent).data.status){t.next=27;break}b(a.data.musicList),n=[],r=0,s=0;case 10:if(!(s<a.data.musicList.musics.length)){t.next=19;break}return l=a.data.musicList.musics[s],t.next=14,L.get("/music/"+l);case 14:"success"===(c=t.sent).data.status?(n.push(c.data.music),r+=c.data.music.length):console.log("error searching song",l);case 16:s++,t.next=10;break;case 19:return y(Array.from(n)),H(r),t.next=23,L.get("/user/"+a.data.musicList.owner);case 23:"success"===(i=t.sent).data.status&&O(i.data.user),t.next=27;break;case 27:t.next=32;break;case 29:t.prev=29,t.t0=t.catch(0),console.log(t.t0);case 32:case"end":return t.stop()}},t,null,[[0,29]])}))).apply(this,arguments)}!function(){t.apply(this,arguments)}()},[e.match.params.id]);var ye=function(){var e=Object(m.a)(d.a.mark(function e(){var t,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!_){e.next=16;break}for(t=[],a=0;a<k.length;a++)t.push(k[a]._id);return e.prev=3,e.next=6,L.post("/updateMusicList",{id:h._id,musics:t});case 6:"success"===e.sent.data.status||console.log("error"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),console.log(e.t0);case 13:j(!1),e.next=17;break;case 16:console.log("won't able to save");case 17:case"end":return e.stop()}},e,null,[[3,10]])}));return function(){return e.apply(this,arguments)}}(),xe=null,Ie=null,Le="",Ae="";if(_?(Le="search-btn disabled",Ae="search-btn"):(Le="search-btn",Ae="search-btn disabled"),h&&C){pe===C._id&&(xe=r.a.createElement(i.b,{mutation:Me},function(t,a){a.loading,a.error;return r.a.createElement(i.b,{mutation:Te},function(a,n){n.loading,n.error;return r.a.createElement(F.d,{style:{cursor:"pointer"},onClick:function(n){return function(t,a,n){if(localStorage.getItem("isSignedIn")){var s=document.getElementById("main_modal");s&&(s.style.display="block",(0,e.updateMainModalContentHandler)(r.a.createElement("div",null,r.a.createElement("h3",null,'Are you sure to delete the playlist "',h.musicListName,'"?'),r.a.createElement(B.a,{className:"search-btn",onClick:function(e){return ve(e,a,n)}},"Confirm"),r.a.createElement(B.a,{className:"cancel-btn",onClick:ke},"Cancel"))))}else alert("Please sign in first!")}(0,t,a)}})})}),Ie=r.a.createElement("div",null,r.a.createElement(B.a,{className:Le,onClick:function(){j(!0)}},"Reorder Songs"),r.a.createElement(B.a,{className:Ae,onClick:ye},"Save Changes")));var He=null;He=_?r.a.createElement(Pe.a,{reorderId:"my-list",reorderGroup:"reorder-group",component:"div",placeholderClassName:"placeholder",draggedClassName:"dragged",lock:"horizontal",holdTime:0,onReorder:function(e,t,a,n,r){y(Object(je.reorder)(k,t,a))},autoScroll:!0,disabled:!1,disableContextMenus:!0},k.map(function(e,t){return r.a.createElement("div",{style:{cursor:"move"},key:e._id},r.a.createElement(we,{reorder_mode:_,updateModalContentHandler:fe,updatePlaylist:he,musicListId:h._id,song:e}))})):k.length>0?r.a.createElement("div",null,k.slice(10*(ue-1),10*ue).map(function(e,t){return r.a.createElement("div",{key:e._id},r.a.createElement(we,{reorder_mode:_,updateModalContentHandler:fe,updatePlaylist:he,musicListId:h._id,index:t,onSongCardClick:ge,song:e}))})):r.a.createElement("div",null,r.a.createElement("center",null,r.a.createElement("h2",null,"This playlist is empty."),r.a.createElement(o.b,{to:"/search"},r.a.createElement(B.a,{style:{color:"white"},className:"search-btn"},"Go find some songs"))));var Fe="";pe===C._id&&(h.isPublic?(Fe="Public Playlist",ze[0]="Make Private"):(Fe="Private Playlist",ze[0]="Make Public"));var qe=0;(qe=Math.floor(M/3600))<10&&(qe="0"+qe);var De=0;(De=Math.floor(M/60))<10&&(De="0"+De);var Be=0;return(Be=Math.floor(M%60))<10&&(Be="0"+Be),r.a.createElement("div",null,r.a.createElement(T.a,null,r.a.createElement("img",{className:"playlist-image",src:w.a,width:175,height:175,alt:""}),r.a.createElement(z.a,null,r.a.createElement("h1",{style:{fontWeight:"bold"}},h.musicListName," "),r.a.createElement("span",null,"by "),r.a.createElement(o.b,{to:"/profile/"+C._id},r.a.createElement("span",{style:{fontSize:"28px"}},C.nickName)),r.a.createElement("h4",{style:{fontWeight:"bold"}},k.length," Songs | ",qe,"h ",De,"m ",Be,"s"),r.a.createElement("h4",{style:{fontWeight:"bold"}}," ",Fe))),r.a.createElement(T.a,{xs:10},r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"50px"}},r.a.createElement(Ee.a,{"aria-label":"play",onClick:function(){var t;(t=Array.from(k))&&t.length>0&&localStorage.setItem("queue",JSON.stringify(t));var a=e.loadQueueSongsToAudioPlayer;t&&t.length>0&&a(t[0])}},r.a.createElement(me.k,null)),Ie,xe,r.a.createElement(Ee.a,{"aria-label":"more","aria-controls":"menu","aria-haspopup":"true",onClick:function(e){l(e.currentTarget)}},r.a.createElement(me.d,null)),r.a.createElement(Ce.a,{id:"menu",anchorEl:s,keepMounted:!0,open:Boolean(s),onClose:function(){l(null)}},ze.map(function(e,t){return r.a.createElement(Oe.a,{key:e,onClick:function(e){return be(e,t,h.isPublic,pe===C._id)}},e)})))),r.a.createElement(Ne,{reorder_mode:_,onTitleClickHandler:function(){if(console.log("handler triggered"),k){var e=1;U||(e=-1),k.sort(function(t,a){return t.musicName<a.musicName?-1*e:t.musicName>a.musicName?1*e:0}),y(Object(Se.a)(k)),$(!U),V(!0),Z(!0),ne(!0)}},onArtistClickHandler:function(){if(console.log("handler triggered"),k){var e=1;W||(e=-1),k.sort(function(t,a){return t.artist<a.artist?-1*e:t.artist>a.artist?1*e:0}),y(Object(Se.a)(k)),$(!0),V(!W),Z(!0),ne(!0)}},onAlbumClickHandler:function(){if(console.log("handler triggered"),k){var e=1;X||(e=-1),k.sort(function(t,a){return t.album<a.album?-1*e:t.album>a.album?1*e:0}),y(Object(Se.a)(k)),$(!0),V(!0),Z(!X),ne(!0)}},onTimeClickHandler:function(){if(console.log("handler triggered"),k){var e=1;ae||(e=-1),k.sort(function(t,a){return t.length<a.length?-1*e:t.length>a.length?1*e:0}),y(Object(Se.a)(k)),$(!0),V(!0),Z(!0),ne(!ae)}}}),He,r.a.createElement(_e.a,{count:parseInt(k.length/10+(k.length%10>0?1:0)),shape:"rounded",size:"large",onChange:function(e,t){console.log("previous page:"+ue),de(t),console.log("clicked :"+t)}}),r.a.createElement("div",{id:"modal",className:"modal"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("span",{onClick:function(){document.getElementById("modal").style.display="none"},className:"close"},"\xd7"),le)))}return r.a.createElement("div",null,"Loading...")}var Fe=["Add to Playlist","Share","Remove from Queue"];function qe(e){var t=e.song,a=null,n=localStorage.getItem("userId"),s=r.a.useState(null),l=Object(Y.a)(s,2),c=l[0],i=l[1],o=r.a.useState(1),u=Object(Y.a)(o,2),p=(u[0],u[1]),f=function(){var e=Object(m.a)(d.a.mark(function e(t,a,n){var r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(a+" "+n),e.prev=1,e.next=4,L.post("/addSong",{musicListID:n,songID:a});case 4:"success"===e.sent.data.status&&(r=document.getElementById("modal"))&&(r.style.display="none"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:case"end":return e.stop()}},e,null,[[1,8]])}));return function(t,a,n){return e.apply(this,arguments)}}(),g=function(){var s=Object(m.a)(d.a.mark(function s(l,c){var o,u,m,g,h,b,v,E,k,y,x;return d.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(p(c),i(null),o="",0===c?o="add_playlist":1===c?o="share":2===c&&(o="remove"),"add_like"!==o){s.next=7;break}s.next=61;break;case 7:if("add_playlist"!==o){s.next=38;break}if(!t||!n){s.next=36;break}if(!(u=document.getElementById("modal"))){s.next=36;break}return u.style.display="block",m=e.updateModalContentHandler,s.prev=13,s.next=16,L.get("/user/musicLists/"+n);case 16:if("success"!==(g=s.sent).data.status){s.next=31;break}h=g.data.musicLists,b=[],v=0;case 21:if(!(v<h.length)){s.next=29;break}return s.next=24,L.get("/musicList/"+h[v]);case 24:"success"===(E=s.sent).data.status&&b.push(E.data.musicList);case 26:v++,s.next=21;break;case 29:a=b.map(function(e,a){return r.a.createElement("div",{onClick:function(a){return f(a,t._id,e._id)},className:"playlist-card"},r.a.createElement("div",null,e.musicListName))}),m(a);case 31:s.next=36;break;case 33:s.prev=33,s.t0=s.catch(13),console.log(s.t0);case 36:s.next=61;break;case 38:if("share"!==o){s.next=41;break}s.next=61;break;case 41:if("remove"!==o){s.next=61;break}if(!t){s.next=61;break}k=JSON.parse(localStorage.getItem("queue")),console.log("before remove"+k),y=0,x=0;case 47:if(!(x<k.length)){s.next=55;break}if(k[x]._id!==t._id){s.next=52;break}return y=x,s.abrupt("break",55);case 52:x++,s.next=47;break;case 55:console.log(y),y>-1&&k.splice(y,1),console.log("after remove"+k),localStorage.setItem("queue",JSON.stringify(k)),(0,e.updateMusicsHandler)(k);case 61:case"end":return s.stop()}},s,null,[[13,33]])}));return function(e,t){return s.apply(this,arguments)}}();if(t){var h=0,b=0;t.length&&((h=Math.floor(t.length/60))<10&&(h="0"+h),(b=Math.floor(t.length%60))<10&&(b="0"+b));var v="N/A";t.artist&&(v=t.artist);var E="N/A";t.album&&(E=t.album);var k="N/A";t.musicName&&(k=t.musicName);var y="";return e.reorder_mode&&(y=r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"25px"}},r.a.createElement(me.b,null))),r.a.createElement("div",null,r.a.createElement(H.a,null,r.a.createElement(T.a,{className:"border-bottom-accent"},r.a.createElement(z.a,{xs:1},y),r.a.createElement(z.a,{xs:3},k),r.a.createElement(z.a,{xs:2},v),r.a.createElement(z.a,{xs:3},E),r.a.createElement(z.a,{xs:1},h,":",b),r.a.createElement(z.a,{xs:1},r.a.createElement(Ee.a,{"aria-label":"play-song",onClick:function(t){return function(){var t=e.index;(0,e.onSongCardClick)(t)}()}},r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"30px"}},r.a.createElement(me.k,null)))),r.a.createElement(z.a,{xs:1},r.a.createElement(Ee.a,{"aria-label":"more","aria-controls":"menu","aria-haspopup":"true",onClick:function(e){i(e.currentTarget)}},r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"30px"}},r.a.createElement(me.d,null))),r.a.createElement(Ce.a,{id:"menu",anchorEl:c,keepMounted:!0,open:Boolean(c),onClose:function(){i(null)}},Fe.map(function(e,t){return r.a.createElement(Oe.a,{key:e,onClick:function(e){return g(e,t)}},e)}))))))}return r.a.createElement("div",null,"error")}var De=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).onTitleClickHandler=function(){(0,a.props.onTitleClickHandler)(),a.setState({title_ascending:!a.state.title_ascending}),a.setState({artist_ascending:!0}),a.setState({album_ascending:!0}),a.setState({time_ascending:!0})},a.onArtistClickHandler=function(){(0,a.props.onArtistClickHandler)(),a.setState({title_ascending:!0}),a.setState({artist_ascending:!a.state.artist_ascending}),a.setState({album_ascending:!0}),a.setState({time_ascending:!0})},a.onAlbumClickHandler=function(){(0,a.props.onAlbumClickHandler)(),a.setState({title_ascending:!0}),a.setState({artist_ascending:!0}),a.setState({album_ascending:!a.state.album_ascending}),a.setState({time_ascending:!0})},a.onTimeClickHandler=function(){(0,a.props.onTimeClickHandler)(),a.setState({title_ascending:!0}),a.setState({artist_ascending:!0}),a.setState({album_ascending:!0}),a.setState({time_ascending:!a.state.time_ascending})},a.placeholder=function(){},a.state={title_ascending:!0,artist_ascending:!0,album_ascending:!0,time_ascending:!0},a}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e="",t="",a="",n="",s="";this.props.reorder_mode?(e="reorder-mode-title",t=this.onTitleClickHandler,a=this.onArtistClickHandler,n=this.onAlbumClickHandler,s=this.onTimeClickHandler):(e="non-reorder-mode-title",t=this.placeholder,a=this.placeholder,n=this.placeholder,s=this.placeholder);var l="",c="",i="",o="";return this.props.reorder_mode&&(l=this.state.title_ascending?r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"15px"}},r.a.createElement(F.b,null)):r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"15px"}},r.a.createElement(F.a,null)),c=this.state.artist_ascending?r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"15px"}},r.a.createElement(F.b,null)):r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"15px"}},r.a.createElement(F.a,null)),i=this.state.album_ascending?r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"15px"}},r.a.createElement(F.b,null)):r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"15px"}},r.a.createElement(F.a,null)),o=this.state.time_ascending?r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"15px"}},r.a.createElement(F.b,null)):r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"15px"}},r.a.createElement(F.a,null))),r.a.createElement("div",null,r.a.createElement(H.a,null,r.a.createElement(T.a,{className:"border-bottom-accent"},r.a.createElement(z.a,{xs:1}),r.a.createElement(z.a,{xs:3,className:e,onClick:t},r.a.createElement("span",null,"Title")," ",l),r.a.createElement(z.a,{xs:2,className:e,onClick:a},r.a.createElement("span",null,"Artist")," ",c),r.a.createElement(z.a,{xs:3,className:e,onClick:n},r.a.createElement("span",null,"Album")," ",i),r.a.createElement(z.a,{xs:2,className:e,onClick:s},r.a.createElement("span",null,"Time")," ",o),r.a.createElement(z.a,{xs:1},"Options"))))}}]),t}(n.Component);function Be(e){var t=r.a.useState(null),a=Object(Y.a)(t,2),s=(a[0],a[1],r.a.useState(0)),l=Object(Y.a)(s,2),c=(l[0],l[1],r.a.useState(null)),i=Object(Y.a)(c,2),o=(i[0],i[1],r.a.useState([])),u=Object(Y.a)(o,2),p=u[0],f=u[1],g=r.a.useState(null),h=Object(Y.a)(g,2),b=(h[0],h[1],r.a.useState(!1)),v=Object(Y.a)(b,2),E=v[0],k=v[1],y=r.a.useState(0),x=Object(Y.a)(y,2),S=x[0],C=x[1],O=r.a.useState(!0),I=Object(Y.a)(O,2),N=I[0],_=I[1],j=r.a.useState(!0),P=Object(Y.a)(j,2),A=P[0],M=P[1],H=r.a.useState(!0),F=Object(Y.a)(H,2),D=F[0],R=F[1],U=r.a.useState(!0),$=Object(Y.a)(U,2),Q=$[0],W=$[1],V=r.a.useState(null),G=Object(Y.a)(V,2),K=G[0],X=G[1],Z=r.a.useState(""),ee=Object(Y.a)(Z,2),te=(ee[0],ee[1]),ae=r.a.useState(0),ne=Object(Y.a)(ae,2),re=ne[0],se=ne[1],le=localStorage.getItem("userId"),ce=JSON.parse(localStorage.getItem("queue")),ie=function(e){f(Object(Se.a)(e))},oe=function(e){X(e)},ue=function(e){var t=e.target;te(t.value)};Object(n.useEffect)(function(){function e(){return(e=Object(m.a)(d.a.mark(function e(){var t,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(console.log(ce),f(ce),se(1),t=0,a=0;a<ce.length;a++)ce[a]&&(t+=ce[a].length);C(t);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[]),Object(n.useEffect)(function(){for(var e=0,t=0;t<p.length;t++)p[t]&&(e+=p[t].length);C(e)},[p]);var de=function(){var e=Object(m.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:E?(localStorage.setItem("queue",JSON.stringify(p)),k(!1)):console.log("won't able to save");case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),pe=function(){var e=Object(m.a)(d.a.mark(function e(t,a){var n,r,s;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==(n=document.getElementById("musicListName").value)){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,L.post("/createMusicListWithMusics",{musicListName:n,musics:a,userId:le});case 6:if("success"!==(r=e.sent).data.status){e.next=13;break}return s=r.data.musicListId,e.next=11,L.post("/addMusicList",{musicListId:s,userId:le});case 11:"success"===e.sent.data.status&&ge();case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),console.log(e.t0);case 18:case"end":return e.stop()}},e,null,[[3,15]])}));return function(t,a){return e.apply(this,arguments)}}(),fe=function(t){if(localStorage.getItem("isSignedIn")){var a=document.getElementById("main_modal");if(a)a.style.display="block",(0,e.updateModalContentHandler)(r.a.createElement("div",null,r.a.createElement("h2",null,"Create New Playlist"),r.a.createElement("div",{style:{padding:"5px"}},r.a.createElement(J.a,{id:"musicListName",size:"small",placeholder:"New List",variant:"outlined",onChange:ue})),r.a.createElement(B.a,{className:"search-btn",onClick:function(e){return pe(e,t)}},"Create"),r.a.createElement(B.a,{className:"cancel-btn",onClick:ge},"Cancel")))}else alert("Please sign in first!")},ge=function(){document.getElementById("main_modal").style.display="none"},he=function(){var e=Object(m.a)(d.a.mark(function e(){var t,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[],a=0;a<p.length;a++)t.push(p[a]._id);fe(t);case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),be=function(){var e=[];f(e),localStorage.setItem("queue",JSON.stringify(e)),ge()},ve=function(t){var a=localStorage.getItem("queue");a=JSON.parse(a);var n=e.loadQueueIndexToAudioPlayer;a.length>0&&n(t)},ke=null,ye="",xe="";if(E?(ye="search-btn disabled",xe="search-btn"):(ye="search-btn",xe="search-btn disabled"),null!==ce){ke=r.a.createElement(r.a.Fragment,null,r.a.createElement(B.a,{className:ye,onClick:function(){k(!0)}},"Reorder Songs"),r.a.createElement(B.a,{className:xe,onClick:de},"Save Changes"));var Ce=null;E&&p&&p.length>0?Ce=r.a.createElement(Pe.a,{reorderId:"my-list",reorderGroup:"reorder-group",component:"div",placeholderClassName:"placeholder",draggedClassName:"dragged",lock:"horizontal",holdTime:0,onReorder:function(e,t,a,n,r){f(Object(je.reorder)(p,t,a))},autoScroll:!0,disabled:!1,disableContextMenus:!0},p.map(function(e,t){return r.a.createElement("div",{style:{cursor:"move"},key:e._id},r.a.createElement(qe,{reorder_mode:E,updateModalContentHandler:oe,song:e,updateMusicsHandler:ie}))})):p&&p.length>0&&(Ce=r.a.createElement("div",null,p.slice(10*(re-1),10*re).map(function(e,t){if(e)return r.a.createElement("div",{key:e._id},r.a.createElement(qe,{reorder_mode:E,updateModalContentHandler:oe,song:e,index:t,onSongCardClick:ve,updateMusicsHandler:ie}))})));var Oe=0;(Oe=Math.floor(S/3600))<10&&(Oe="0"+Oe);var Ie=0;(Ie=Math.floor(S/60))<10&&(Ie="0"+Ie);var we=0;return(we=Math.floor(S%60))<10&&(we="0"+we),r.a.createElement("div",null,r.a.createElement(T.a,null,r.a.createElement("img",{className:"playlist-image",src:w.a,width:175,height:175,alt:""}),r.a.createElement(z.a,null,r.a.createElement("h1",{style:{fontWeight:"bold"}}," Queue "),r.a.createElement("h4",{style:{fontWeight:"bold"}},p.length," Songs | ",Oe,"h ",Ie,"m ",we,"s"),r.a.createElement(B.a,{className:"search-btn",onClick:he},"Save As Playlist"),r.a.createElement(B.a,{className:"search-btn",onClick:function(){if(localStorage.getItem("isSignedIn")){var t=document.getElementById("main_modal");t&&(t.style.display="block",(0,e.updateModalContentHandler)(r.a.createElement("div",null,r.a.createElement("h3",null,"Are you sure to clear the queue?"),r.a.createElement(B.a,{className:"search-btn",onClick:be},"Confirm"),r.a.createElement(B.a,{className:"cancel-btn",onClick:ge},"Cancel"))))}else alert("Please sign in first!")}},"Clear Queue"))),r.a.createElement(Ee.a,{"aria-label":"play",onClick:function(){var t=localStorage.getItem("queue");t=JSON.parse(t);var a=e.loadQueueIndexToAudioPlayer;t.length>0&&a(0)}},r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"40px"}},r.a.createElement(me.k,null))),ke,r.a.createElement(De,{reorder_mode:E,onTitleClickHandler:function(){if(console.log("handler triggered"),p){var e=1;N||(e=-1),p.sort(function(t,a){return t.musicName<a.musicName?-1*e:t.musicName>a.musicName?1*e:0}),f(Object(Se.a)(p)),_(!N),M(!0),R(!0),W(!0)}},onArtistClickHandler:function(){if(console.log("handler triggered"),p){var e=1;A||(e=-1),p.sort(function(t,a){return t.artist<a.artist?-1*e:t.artist>a.artist?1*e:0}),f(Object(Se.a)(p)),_(!0),M(!A),R(!0),W(!0)}},onAlbumClickHandler:function(){if(console.log("handler triggered"),p){var e=1;D||(e=-1),p.sort(function(t,a){return t.album<a.album?-1*e:t.album>a.album?1*e:0}),f(Object(Se.a)(p)),_(!0),M(!0),R(!D),W(!0)}},onTimeClickHandler:function(){if(console.log("handler triggered"),p){var e=1;Q||(e=-1),p.sort(function(t,a){return t.length<a.length?-1*e:t.length>a.length?1*e:0}),f(Object(Se.a)(p)),_(!0),M(!0),R(!0),W(!Q)}}}),Ce,r.a.createElement(_e.a,{count:parseInt(p.length/10+(p.length%10>0?1:0)),shape:"rounded",size:"large",onChange:function(e,t){se(t)}}),r.a.createElement("div",{id:"modal",className:"modal"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("span",{onClick:function(){var e=document.getElementById("modal");e&&(e.style.display="none")},className:"close"},"\xd7"),K)))}return r.a.createElement("div",null,"Loading...")}var Re=a(82),Ue=(n.Component,a(162)),$e=["Add to Queue","Add to Playlist","Share"];function Qe(e){var t=e.song,a=localStorage.getItem("userId"),n=null,s=r.a.useState(null),l=Object(Y.a)(s,2),c=l[0],i=l[1],o=r.a.useState(1),u=Object(Y.a)(o,2),p=(u[0],u[1]),f=function(){var a=Object(m.a)(d.a.mark(function a(){var n,r,s,l,c,i,o,u,m,p,f,g;return d.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(localStorage.getItem("isSignedIn")){a.next=3;break}return alert("Please sign in to use this function."),a.abrupt("return");case 3:return n=t.name,r=t.artists[0].name,s=t.id,l=t.album.name,c=Math.round(t.duration_ms/1e3),a.prev=8,a.next=11,L.post("/createMusic",{musicName:n,URI:s,album:l,length:c,artist:r});case 11:if("success"!==(i=a.sent).data.status){a.next=20;break}return o=e.loadQueueIndexToAudioPlayer,u=(u=localStorage.getItem("queue"))?JSON.parse(u):[],a.next=18,L.get("/music/"+i.data.musicId);case 18:if("success"===(m=a.sent).data.status){for(p=!1,f=u.length-1,g=0;g<u.length;g++)u[g]&&u[g]._id===m.data.music._id&&(p=!0,f=g);p||(u.push(m.data.music),f=u.length-1),localStorage.setItem("queue",JSON.stringify(u)),o(f)}case 20:a.next=24;break;case 22:a.prev=22,a.t0=a.catch(8);case 24:case"end":return a.stop()}},a,null,[[8,22]])}));return function(){return a.apply(this,arguments)}}(),g=function(){var e=Object(m.a)(d.a.mark(function e(t,a,n){var r,s,l,c,i,o,u,m;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.name,s=a.artists[0].name,l=a.id,c=a.album.name,i=Math.round(a.duration_ms/1e3),e.prev=5,e.next=8,L.post("/createMusic",{musicName:r,URI:l,album:c,length:i,artist:s});case 8:if("success"!==(o=e.sent).data.status){e.next=15;break}return u=o.data.musicId,e.next=13,L.post("/addSong",{musicListID:n,songID:u});case 13:"success"===e.sent.data.status&&(m=document.getElementById("modal"))&&(m.style.display="none");case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(5),console.log(e.t0);case 20:case"end":return e.stop()}},e,null,[[5,17]])}));return function(t,a,n){return e.apply(this,arguments)}}(),h=function(){var s=Object(m.a)(d.a.mark(function s(l,c){var o,u,m,f,h,b,v,E,k,y,x,S,C,O,I,w,N,_;return d.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(p(c),i(null),localStorage.getItem("isSignedIn")){s.next=5;break}return alert("Please sign in to use this function."),s.abrupt("return");case 5:if(0!==c){s.next=33;break}if(!t||!a){s.next=31;break}return o=(o=localStorage.getItem("queue"))?JSON.parse(o):[],u=t.name,m=t.artists[0].name,f=t.id,h=t.album.name,b=Math.round(t.duration_ms/1e3),s.prev=14,s.next=17,L.post("/createMusic",{musicName:u,URI:f,album:h,length:b,artist:m});case 17:if("success"!==(v=s.sent).data.status){s.next=26;break}return console.log(v.data.musicId),E=v.data.musicId,s.next=23,L.get("/music/"+E);case 23:k=s.sent,console.log(E),"success"===k.data.status&&(o.length>0?(y=o.map(function(e){return e._id===k.data.music._id}).reduce(function(e,t){return e||t}),console.log(y),y||(o.push(k.data.music),localStorage.setItem("queue",JSON.stringify(o)))):(o.push(k.data.music),localStorage.setItem("queue",JSON.stringify(o))));case 26:s.next=31;break;case 28:s.prev=28,s.t0=s.catch(14),console.log(s.t0);case 31:s.next=67;break;case 33:if(1!==c){s.next=66;break}if(!t||!a){s.next=64;break}if(!(x=document.getElementById("modal"))){s.next=64;break}return S=e.childSongIdHandler,x.style.display="block",S(t.id,t),C=e.updateModalContentHandler,s.prev=41,s.next=44,L.get("/user/musicLists/"+a);case 44:if("success"!==(O=s.sent).data.status){s.next=59;break}I=O.data.musicLists,w=[],N=0;case 49:if(!(N<I.length)){s.next=57;break}return s.next=52,L.get("/musicList/"+I[N]);case 52:"success"===(_=s.sent).data.status&&w.push(_.data.musicList);case 54:N++,s.next=49;break;case 57:n=w.map(function(e,a){return r.a.createElement("div",{key:a,onClick:function(a){return g(a,t,e._id)},className:"playlist-card"},r.a.createElement("div",null,e.musicListName))}),C(n);case 59:s.next=64;break;case 61:s.prev=61,s.t1=s.catch(41),console.log(s.t1);case 64:s.next=67;break;case 66:case 67:case"end":return s.stop()}},s,null,[[14,28],[41,61]])}));return function(e,t){return s.apply(this,arguments)}}();if(t){var b=0;(b=Math.floor(t.duration_ms/1e3/60))<10&&(b="0"+b);var v=0;(v=Math.floor(t.duration_ms/1e3%60))<10&&(v="0"+v);var E="N/A";t.artists&&(E=t.artists[0].name);var k="N/A";return t.album.name&&(k=t.album.name),r.a.createElement("div",null,r.a.createElement(H.a,null,r.a.createElement(T.a,{className:"border-bottom-accent"},r.a.createElement(z.a,{xs:1}),r.a.createElement(z.a,{xs:3},t.name),r.a.createElement(z.a,{xs:2},E),r.a.createElement(z.a,{xs:3},k),r.a.createElement(z.a,{xs:1},b,":",v),r.a.createElement(z.a,{xs:1},r.a.createElement(Ee.a,{"aria-label":"play-song",onClick:function(e){return f(e)}},r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"30px"}},r.a.createElement(me.k,null)))),r.a.createElement(z.a,{xs:1},r.a.createElement(Ee.a,{"aria-label":"more","aria-controls":"menu","aria-haspopup":"true",onClick:function(e){i(e.currentTarget)}},r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"30px"}},r.a.createElement(me.d,null))),r.a.createElement(Ce.a,{id:"menu",anchorEl:c,keepMounted:!0,open:Boolean(c),onClose:function(){i(null)}},$e.map(function(e,t){return r.a.createElement(Oe.a,{key:e,onClick:function(e){return h(e,t)}},e)}))))))}return r.a.createElement("div",null,"error")}var Je=function(e){function t(){return Object(p.a)(this,t),Object(g.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(H.a,null,r.a.createElement(T.a,{className:"border-bottom-accent"},r.a.createElement(z.a,{xs:1}),r.a.createElement(z.a,{xs:3},"Title"),r.a.createElement(z.a,{xs:2},"Artist"),r.a.createElement(z.a,{xs:3},"Album"),r.a.createElement(z.a,{xs:2},"Time"),r.a.createElement(z.a,{xs:1},"Options"))))}}]),t}(n.Component),We=function(e){function t(){return Object(p.a)(this,t),Object(g.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props.user;return e?r.a.createElement("div",null,r.a.createElement(o.b,{to:"/profile/"+e._id},r.a.createElement(H.a,null,r.a.createElement(T.a,{className:"border-bottom-accent"},r.a.createElement(z.a,{xs:4},e.nickName))))):r.a.createElement("div",null,"error")}}]),t}(n.Component),Ve=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).getNickName=function(){var e=Object(m.a)(d.a.mark(function e(t){var n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="",e.prev=1,e.next=4,L.post("/user/nickName",{id:t});case 4:"success"===(r=e.sent).data.status&&(console.log("success"),n=r.data.nickName,a.setState({owner:n})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:case"end":return e.stop()}},e,null,[[1,8]])}));return function(t){return e.apply(this,arguments)}}(),a.state={owner:""},a}return Object(b.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.playlist;e&&this.getNickName(e.owner)}},{key:"render",value:function(){var e=this.props.playlist;if(e){var t=this.state.owner;return r.a.createElement("div",null,r.a.createElement(o.b,{to:"/playlist/"+e._id,style:{color:"#ed4e85"}},r.a.createElement(H.a,null,r.a.createElement(T.a,{className:"border-bottom-accent"},r.a.createElement(z.a,{xs:1},"\u2661"),r.a.createElement(z.a,{xs:3},e.musicListName),r.a.createElement(z.a,{xs:3},t)))))}return r.a.createElement("div",null,"error")}}]),t}(n.Component),Ge=function(e){function t(){return Object(p.a)(this,t),Object(g.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(H.a,null,r.a.createElement(T.a,{className:"border-bottom-accent"},r.a.createElement(z.a,{xs:4},"Name"))))}}]),t}(n.Component),Ye=function(e){function t(){return Object(p.a)(this,t),Object(g.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(H.a,null,r.a.createElement(T.a,{className:"border-bottom-accent"},r.a.createElement(z.a,{xs:1},"Liked"),r.a.createElement(z.a,{xs:3},"Name"),r.a.createElement(z.a,{xs:3},"Owner"))))}}]),t}(n.Component);a(245);function Ke(){var e=Object(K.a)(["\n    mutation addMusicToMusicList(\n        $musicListId: String!\n        $musicId: String!\n    ) {\n        addMusicToMusicList(\n        id: $musicListId\n        musicId: $musicId\n    ){\n    _id\n    }\n    }\n"]);return Ke=function(){return e},e}function Xe(){var e=Object(K.a)(["\n    query musicList($musicListId: String) {\n        musicList(id: $musicListId) {\n            musicListName\n            owner{\n                _id\n            }\n            musics{\n                _id\n            }\n        }\n    }\n"]);return Xe=function(){return e},e}function Ze(){var e=Object(K.a)(["\n    query user($userId: String) {\n        user(id: $userId) {\n            musicLists{\n                _id\n            }\n        }\n    }\n"]);return Ze=function(){return e},e}ee()(Ze()),ee()(Xe()),ee()(Ke());var et=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).handleChange=function(e){var t=e.target;a.setState(function(e){return Object(Q.a)({},e,Object($.a)({},t.id,t.value))})},a.changePageHandler=function(e,t){console.log("previous page:"+a.state.page),a.setState({page:t}),console.log("clicked :"+t)},a.onClick=function(){var e=Object(m.a)(d.a.mark(function e(t){var n,r,s;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=a.state.select,r=a.state.search_text,console.log(n,r),""===r){e.next=15;break}return e.prev=5,e.next=8,L.post("/search/"+n,{search_text:r});case 8:"success"===(s=e.sent).data.status&&(console.log("success"),console.log(s.data.results),a.setState({search_results_mode:n}),a.setState({search_results:s.data.results})),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),console.log(e.t0);case 15:case"end":return e.stop()}},e,null,[[5,12]])}));return function(t){return e.apply(this,arguments)}}(),a.onClose=function(){var e=document.getElementById("modal");e&&(e.style.display="none")},a.onAddPlaylistClick=function(){var e=Object(m.a)(d.a.mark(function e(t,n,r){var s,l,c,i,o,u,m,p,f,g;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),""!==(s=a.state.songID)&&console.log(n,s),e.prev=3,l=a.state.songInfo.name,c=a.state.songInfo.artists[0].name,i=a.state.songID,o=a.state.songInfo.album.name,u=Math.round(a.state.songInfo.duration_ms/1e3),e.next=11,L.post("/createMusic",{musicName:l,URI:i,album:o,length:u,artist:c});case 11:if("success"!==(m=e.sent).data.status){e.next=22;break}return console.log(a.props.userId),console.log(m.data.musicId),e.next=17,L.get("/musicList/"+n);case 17:"success"==(p=e.sent).data.status&&(f=p.data.musicList.musics,console.log(f),console.log(f.map(function(e){return e===m.data.musicId})),f.length>0?(g=!0,f.forEach(function(e){e===m.data.musicId&&(g=!1)}),console.log(g),g&&r({variables:{musicId:m.data.musicId,musicListId:n}})):r({variables:{musicId:m.data.musicId,musicListId:n}})),a.onClose(),e.next=23;break;case 22:alert("Playlist creation failed");case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(3),console.log(e.t0);case 28:case"end":return e.stop()}},e,null,[[3,25]])}));return function(t,a,n){return e.apply(this,arguments)}}(),a.updateModalContentHandler=function(e){a.setState({modal_content:e})},a.state={select:"song",search_text:"",search_results:[],search_results_mode:"song",songID:"",songInfo:{},page:1,musics:[],initialized:!1,modal_content:null},a.childSongIdHandler=a.childSongIdHandler.bind(Object(M.a)(Object(M.a)(a))),a.updateModalContentHandler=a.updateModalContentHandler.bind(Object(M.a)(Object(M.a)(a))),a}return Object(b.a)(t,e),Object(f.a)(t,[{key:"childSongIdHandler",value:function(e,t){console.log(e),console.log(t),this.setState({songID:e,songInfo:t})}},{key:"render",value:function(){var e=this,t=this.state.search_results,a=this.state.search_results_mode,n="",s="";localStorage.getItem("userId");return console.log("select is",a),t&&("song"===a||"artist"===a||"album"===a?(n=r.a.createElement(Je,null),s=t.slice(10*(this.state.page-1),10*this.state.page).map(function(t){return r.a.createElement(Qe,{updateModalContentHandler:e.updateModalContentHandler,childSongIdHandler:e.childSongIdHandler,loadQueueIndexToAudioPlayer:e.props.loadQueueIndexToAudioPlayer,key:t.id,song:t})})):"user"===a?(n=r.a.createElement(Ge,null),s=t.slice(10*(this.state.page-1),10*this.state.page).map(function(e){return r.a.createElement(We,{key:e._id,user:e})})):"playlist"===a&&(n=r.a.createElement(Ye,null),s=t.slice(10*(this.state.page-1),10*this.state.page).map(function(e){return r.a.createElement(Ve,{key:e._id,playlist:e})}))),r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("h1",null,"Search"),r.a.createElement("h6",null,"Type to search:"),r.a.createElement("form",null,r.a.createElement("div",{style:{padding:"5px"}},r.a.createElement(Ue.a,{defaultValue:"song",style:{margin:"5px"},onChange:this.handleChange,id:"select"},r.a.createElement("option",{value:"song"},"Song"),r.a.createElement("option",{value:"artist"},"Artist"),r.a.createElement("option",{value:"album"},"Album"),r.a.createElement("option",{value:"user"},"User"),r.a.createElement("option",{value:"playlist"},"Playlist")),r.a.createElement(J.a,{id:"search_text",size:"small",placeholder:"search",variant:"outlined",onChange:this.handleChange}),r.a.createElement(B.a,{onClick:this.onClick,type:"submit",className:"search-btn"},"Search")),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",{className:"border-bottom-accent"})),n,s,r.a.createElement(_e.a,{count:parseInt(t.length/10+(t.length%10>0?1:0)),shape:"rounded",size:"large",onChange:this.changePageHandler}),r.a.createElement("div",{id:"modal",className:"modal"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("span",{onClick:this.onClose,className:"close"},"\xd7"),this.state.modal_content)))}}]),t}(n.Component),tt=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).getSelf=Object(m.a)(d.a.mark(function e(){var t,n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("userId"),e.prev=1,e.next=4,L.post("/user",{id:t});case 4:"success"===(n=e.sent).data.status&&(r=n.data.user,a.setState({self:r})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:case"end":return e.stop()}},e,null,[[1,8]])})),a.getUser=function(){var e=Object(m.a)(d.a.mark(function e(t){var n,r,s,l,c,i,o,u,m;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="",e.prev=1,e.next=4,L.post("/user",{id:t});case 4:if("success"!==(r=e.sent).data.status){e.next=27;break}return n=r.data.user,e.next=9,L.get("/user/musicLists/"+n._id);case 9:if("success"!==(s=e.sent).data.status){e.next=25;break}l=s.data.musicLists,c=[],i=0;case 14:if(!(i<l.length)){e.next=23;break}return o=l[i],e.next=18,L.get("/musicList/"+o);case 18:"success"===(u=e.sent).data.status?(m=u.data.musicList).isPublic&&c.push(m):console.log("error searching playlist",o);case 20:i++,e.next=14;break;case 23:a.setState({publicPlaylists:c}),a.setState({user:n});case 25:e.next=27;break;case 27:e.next=32;break;case 29:e.prev=29,e.t0=e.catch(1),console.log(e.t0);case 32:case"end":return e.stop()}},e,null,[[1,29]])}));return function(t){return e.apply(this,arguments)}}(),a.onAddFriendClick=Object(m.a)(d.a.mark(function e(){var t,n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.state.self,n=a.state.user,!t||!n){e.next=13;break}return e.prev=3,e.next=6,L.post("/sendFriendRequest",{userID:t._id,target_userID:n._id});case 6:"success"===(r=e.sent).data.status&&(a.setState({user:r.data.target_user}),a.setState({self:r.data.user})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),console.log(e.t0);case 13:case"end":return e.stop()}},e,null,[[3,10]])})),a.onRemoveFriendClick=Object(m.a)(d.a.mark(function e(){var t,n,s,l,c;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=a.state.self,n=a.state.user,t&&n&&(localStorage.getItem("isSignedIn")?(s=document.getElementById("main_modal"))&&(s.style.display="block",l=a.props.updateModalContentHandler,c=r.a.createElement("div",null,r.a.createElement("h3",null,"Are you sure remove this friend?"),r.a.createElement(B.a,{className:"search-btn",onClick:function(e){return a.onRemoveFriendConfirm(e,t,n)}},"Confirm"),r.a.createElement(B.a,{className:"cancel-btn",onClick:a.closeModal},"Cancel")),l(c)):alert("Please sign in first!"));case 3:case"end":return e.stop()}},e)})),a.onRemoveFriendConfirm=function(){var e=Object(m.a)(d.a.mark(function e(t,n,r){var s;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L.post("/removeFriend",{userID:n._id,target_userID:r._id});case 3:"success"===(s=e.sent).data.status&&(a.setState({user:s.data.target_user}),a.setState({self:s.data.user})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:a.closeModal();case 11:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a,n){return e.apply(this,arguments)}}(),a.closeModal=function(){document.getElementById("main_modal").style.display="none"},a.state={user:null,publicPlaylists:[],self:null,now_playing:"none"},a}return Object(b.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.match.params.id;""!==e&&(this.getUser(e),this.getSelf()),console.log("props is",this.props),this.props.now_playing&&this.setState({now_playing:this.props.now_playing})}},{key:"componentWillReceiveProps",value:function(e){var t=e.match.params.id;""!==t&&(this.getUser(t),this.getSelf()),e.now_playing&&this.setState({now_playing:e.now_playing})}},{key:"render",value:function(){var e=this.props.match.params.id,t=this.state.user,a="",n="",s="",l="",c=[];this.state.publicPlaylists&&(s=(c=this.state.publicPlaylists).length>0?c.map(function(e,t){return r.a.createElement("div",{key:t},r.a.createElement(N,{className:"grid-item",playlist:e}))}):r.a.createElement("div",null,"No public playlists available yet."));var i="";return this.state.self&&this.state.user&&(a=this.state.self,e!==(n=this.state.self._id)?(i=a.friends.includes(e)?r.a.createElement("div",null,r.a.createElement(B.a,{onClick:this.onRemoveFriendClick,className:"remove-friend-btn"},"Remove Friend")):r.a.createElement("div",null,r.a.createElement(B.a,{onClick:this.onAddFriendClick,className:"add-friend-btn"},"Add Friend")),t.friendRequests.includes(n)&&(i=r.a.createElement("div",null,r.a.createElement(B.a,{style:{cursor:"default"},className:"pending-friend-btn"},"Request sent"))),l=r.a.createElement(D,{now_playing:this.state.now_playing,user:t})):l=r.a.createElement(D,{now_playing:this.state.now_playing,user:a})),t?r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("h1",null,"Profile"),l,i,r.a.createElement("hr",null),r.a.createElement("h2",null,"Public Playlists"),r.a.createElement("div",{className:"grid-container"},s)):r.a.createElement(r.a.Fragment,null,"Loading...")}}]),t}(n.Component);a(291),a(300),a(295),a(293),a(294),a(292);var at=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).handleChange=function(e){var t=e.target;a.setState(function(e){return Object(Q.a)({},e,Object($.a)({},t.id,t.value))})},a.onSubmit=function(){var e=Object(m.a)(d.a.mark(function e(t){var n,r,s;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=a.state.email,r=a.state.password,""===n||""===r){e.next=14;break}return e.prev=4,e.next=7,L.post("/signin",{email:n,password:r});case 7:"success"===(s=e.sent).data.status?(console.log("success"),a.props.signedIn(s.data.nickName,s.data.userId),a.props.history.push("/")):"failed"===s.data.status?alert("Wrong credentials. Please try again."):"not verified"===s.data.status&&(console.log("not verified"),alert("Your account is not verified yet. Please follow the instructions in the verification email.")),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),console.log(e.t0);case 14:case"end":return e.stop()}},e,null,[[4,11]])}));return function(t){return e.apply(this,arguments)}}(),a.state={email:"",password:"",status:""},a}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("h1",null,"Sign In"),r.a.createElement("form",{onSubmit:function(t){return e.onSubmit(t)}},r.a.createElement("h6",null,"Email Address:"),r.a.createElement("div",{style:{padding:"5px"}},r.a.createElement(J.a,{id:"email",size:"small",placeholder:"email address",variant:"outlined",onChange:this.handleChange})),r.a.createElement("h6",null,"Password:"),r.a.createElement("div",{style:{padding:"5px"}},r.a.createElement(J.a,{id:"password",type:"password",size:"small",placeholder:"password",variant:"outlined",onChange:this.handleChange})),r.a.createElement("br",null),r.a.createElement(B.a,{type:"submit",className:"search-btn"},"Sign In"),r.a.createElement(o.b,{to:"/forgetpassword"},r.a.createElement(B.a,{className:"search-btn"},"Forget Password")),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",{className:"border-bottom-accent"})))}}]),t}(n.Component);function nt(){var e=Object(K.a)(["\n    query userByUserName($userName: String!) {\n        userByUserName(userName: $userName) {\n            _id\n            userName\n        }\n    }\n"]);return nt=function(){return e},e}function rt(){var e=Object(K.a)(["\n    mutation AddUser(\n        $userName: String!,\n        $password: String!,\n        $nickName: String!,\n        $verified: Boolean!\n        ) {\n        addUser(\n            userName: $userName,\n            password: $password,\n            nickName: $nickName,\n            verified: $verified\n            ) {\n            _id\n        }\n    }\n"]);return rt=function(){return e},e}var st=ee()(rt()),lt=(ee()(nt()),function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).handleChange=function(e){var t=e.target;a.setState(function(e){return Object(Q.a)({},e,Object($.a)({},t.id,t.value))})},a.onCompleted=function(){},a.onSubmit=function(){var e=Object(m.a)(d.a.mark(function e(t,n){var r,s;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),r=a.state.email,!1!==/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(r)){e.next=7;break}return alert("Please enter an email address with correct format."),e.abrupt("return");case 7:if(console.log(r),""===a.state.email||!a.state.nickName||""===a.state.password||""===a.state.passwordConfirm){e.next=37;break}if(a.state.password!==a.state.passwordConfirm){e.next=34;break}return e.prev=10,e.next=13,L.post("/register",{email:r});case 13:if("success"!==e.sent.data.status){e.next=26;break}return(s=document.getElementById("loading_toast")).className="show",setTimeout(function(){s.className=s.className.replace("show","")},3e3),e.next=20,n({variables:{userName:a.state.email,password:a.state.password,nickName:a.state.nickName,verified:!1}});case 20:return e.next=22,L.post("/sendVerifyEmail",{email:r});case 22:"success"===e.sent.data.status?(console.log("success"),a.props.history.push("/emailsent")):a.props.history.push("/error"),e.next=27;break;case 26:alert("This email has been registered.");case 27:e.next=32;break;case 29:e.prev=29,e.t0=e.catch(10),console.log(e.t0);case 32:e.next=35;break;case 34:alert("Password do not match");case 35:e.next=38;break;case 37:alert("All fields must be filled");case 38:case"end":return e.stop()}},e,null,[[10,29]])}));return function(t,a){return e.apply(this,arguments)}}(),a.state={email:"",nickName:"New User",password:"",passwordConfirm:"",status:""},a}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(i.b,{mutation:st,onCompleted:this.onCompleted},function(t,a){a.loading,a.error;return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(a){return e.onSubmit(a,t)}},r.a.createElement("br",null),r.a.createElement("h1",null,"Sign Up"),r.a.createElement("h6",null,"Email Address:"),r.a.createElement("div",{style:{padding:"5px"}},r.a.createElement(J.a,{size:"small",placeholder:"email address",variant:"outlined",id:"email",onChange:e.handleChange})),r.a.createElement("h6",null,"Nickname:"),r.a.createElement("div",{style:{padding:"5px"}},r.a.createElement(J.a,{size:"small",placeholder:"nickname",variant:"outlined",id:"nickName",onChange:e.handleChange})),r.a.createElement("h6",null,"Password:"),r.a.createElement("div",{style:{padding:"5px"}},r.a.createElement(J.a,{type:"password",size:"small",placeholder:"password",variant:"outlined",id:"password",onChange:e.handleChange})),r.a.createElement("h6",null,"Confirm Password:"),r.a.createElement("div",{style:{padding:"5px"}},r.a.createElement(J.a,{type:"password",size:"small",placeholder:"confirm password",variant:"outlined",id:"passwordConfirm",onChange:e.handleChange})),r.a.createElement("br",null),r.a.createElement(B.a,{type:"submit",className:"search-btn"},"Sign Up"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",{className:"border-bottom-accent"})))})}}]),t}(n.Component)),ct=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).handleChange=function(e){var t=e.target;a.setState(function(e){return Object(Q.a)({},e,Object($.a)({},t.id,t.value))})},a.onSubmit=function(){var e=Object(m.a)(d.a.mark(function e(t){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""===(n=a.state.email)){e.next=13;break}return e.prev=3,e.next=6,L.post("/forgetPassword",{email:n});case 6:e.sent&&(console.log("success"),a.props.history.push("/emailsent")),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),console.log(e.t0);case 13:case"end":return e.stop()}},e,null,[[3,10]])}));return function(t){return e.apply(this,arguments)}}(),a.state={email:""},a}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("h1",null,"Forget Password"),r.a.createElement("form",{onSubmit:function(t){return e.onSubmit(t)}},r.a.createElement("h6",null,"Enter your email address:"),r.a.createElement("div",{style:{padding:"5px"}},r.a.createElement(J.a,{id:"email",size:"small",placeholder:"email address",variant:"outlined",onChange:this.handleChange})),r.a.createElement(B.a,{type:"submit",className:"search-btn"},"Submit"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",{className:"border-bottom-accent"})))}}]),t}(n.Component),it=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(g.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).onClick=function(){var e=Object(m.a)(d.a.mark(function e(t){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,L.post("/verify",{id:a.props.match.params.id});case 4:"success"===(n=e.sent).data.status?(console.log("success"),a.props.signedIn(n.data.nickName,n.data.userId),a.props.history.push("/")):a.props.history.push("/error"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:case"end":return e.stop()}},e,null,[[1,8]])}));return function(t){return e.apply(this,arguments)}}(),a}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){console.log(this.props.location.state);return this.props.location.state&&this.props.location.state.changepassword&&"/changepassword",r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("h1",null,"Verification"),r.a.createElement(B.a,{onClick:this.onClick,className:"search-btn"},"Verify"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",{className:"border-bottom-accent"}))}}]),t}(n.Component),ot=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).handleChange=function(e){var t=e.target;a.setState(function(e){return Object(Q.a)({},e,Object($.a)({},t.id,t.value))})},a.onSubmit=function(){var e=Object(m.a)(d.a.mark(function e(t){var n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=a.state.newPassword,r=a.state.newPasswordConfirm,""===n||""===r){e.next=18;break}if(n!==r){e.next=17;break}return e.prev=5,e.next=8,L.post("/changePassword",{id:a.props.match.params.id,newPassword:n});case 8:"success"===e.sent.data.status?(console.log("success"),alert("Password has changed successfully"),a.props.history.push("/")):a.props.history.push("/error"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),console.log(e.t0);case 15:e.next=18;break;case 17:alert("New passwords doesn't match. Please try again.");case 18:case"end":return e.stop()}},e,null,[[5,12]])}));return function(t){return e.apply(this,arguments)}}(),a.state={newPassword:"",newPasswordConfirm:""},a}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("h1",null,"Change Password"),r.a.createElement("form",{onSubmit:function(t){return e.onSubmit(t)}},r.a.createElement("h6",null,"Old Password:"),r.a.createElement("div",{style:{padding:"5px"}},r.a.createElement(J.a,{id:"oldPassword",size:"small",type:"password",placeholder:"old password",variant:"outlined",onChange:this.handleChange})),r.a.createElement("h6",null,"New Password:"),r.a.createElement("div",{style:{padding:"5px"}},r.a.createElement(J.a,{id:"newPassword",type:"password",size:"small",placeholder:"new password",variant:"outlined",onChange:this.handleChange})),r.a.createElement("h6",null,"Confirm New Password:"),r.a.createElement("div",{style:{padding:"5px"}},r.a.createElement(J.a,{id:"newPasswordConfirm",type:"password",size:"small",placeholder:"confirm new password",variant:"outlined",onChange:this.handleChange})),r.a.createElement("br",null),r.a.createElement(B.a,{type:"submit",className:"search-btn"},"Submit"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",{className:"border-bottom-accent"})))}}]),t}(n.Component),ut=(n.Component,function(e){function t(){return Object(p.a)(this,t),Object(g.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,"An email has been sent you your email address.")}}]),t}(n.Component)),dt=function(e){function t(){return Object(p.a)(this,t),Object(g.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,"Something is wrong. Please try again.")}}]),t}(n.Component),mt=a(296),pt=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).nickNameControl=function(){var e=localStorage.getItem("userNickName");return e?r.a.createElement("div",null,"Welcome ",e):r.a.createElement("div",null)},a}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement(H.a,{className:"banner-container"},r.a.createElement(mt.a,{container:!0,spacing:0},r.a.createElement(mt.a,{item:!0,xs:3},r.a.createElement("div",null,"Mixtapez")),r.a.createElement(mt.a,{item:!0,xs:3}),r.a.createElement(mt.a,{item:!0,xs:5},this.nickNameControl())))}}]),t}(n.Component),ft=["Add to Queue","Add to Playlist","Share"];function gt(e){var t=e.song,a=null,n=localStorage.getItem("userId"),s=r.a.useState(null),l=Object(Y.a)(s,2),c=l[0],i=l[1],o=r.a.useState(1),u=Object(Y.a)(o,2),p=(u[0],u[1]),f=function(){var e=Object(m.a)(d.a.mark(function e(t,a,n){var r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(a+" "+n),e.prev=1,e.next=4,L.post("/addSong",{musicListID:n,songID:a});case 4:"success"===e.sent.data.status&&(r=document.getElementById("modal"))&&(r.style.display="none"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:case"end":return e.stop()}},e,null,[[1,8]])}));return function(t,a,n){return e.apply(this,arguments)}}(),g=function(){var s=Object(m.a)(d.a.mark(function s(l,c){var o,u,m,g,h,b,v,E,k,y,x,S;return d.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(p(c),i(null),o="",0===c?o="add_queue":1===c?o="add_playlist":2===c&&(o="share"),"add_queue"!==o){s.next=22;break}return s.prev=5,u=(u=localStorage.getItem("queue"))?JSON.parse(u):[],console.log(t._id),m=t._id,s.next=12,L.get("/music/"+m);case 12:g=s.sent,console.log(g.data.music),"success"==g.data.status&&(u.length>0?(h=u.map(function(e){return e._id===g.data.music._id}).reduce(function(e,t){return e||t}),console.log(h),h||(u.push(g.data.music),localStorage.setItem("queue",JSON.stringify(u)))):(u.push(g.data.music),localStorage.setItem("queue",JSON.stringify(u)))),s.next=20;break;case 17:s.prev=17,s.t0=s.catch(5),console.log(s.t0);case 20:s.next=57;break;case 22:if("add_like"!==o){s.next=25;break}s.next=57;break;case 25:if("add_playlist"!==o){s.next=56;break}if(!t||!n){s.next=54;break}if(!(b=document.getElementById("modal"))){s.next=54;break}return b.style.display="block",v=e.updateModalContentHandler,s.prev=31,s.next=34,L.get("/user/musicLists/"+n);case 34:if("success"!==(E=s.sent).data.status){s.next=49;break}k=E.data.musicLists,y=[],x=0;case 39:if(!(x<k.length)){s.next=47;break}return s.next=42,L.get("/musicList/"+k[x]);case 42:"success"===(S=s.sent).data.status&&y.push(S.data.musicList);case 44:x++,s.next=39;break;case 47:a=y.map(function(e,a){return r.a.createElement("div",{onClick:function(a){return f(a,t._id,e._id)},className:"playlist-card"},r.a.createElement("div",null,e.musicListName))}),v(a);case 49:s.next=54;break;case 51:s.prev=51,s.t1=s.catch(31),console.log(s.t1);case 54:s.next=57;break;case 56:case 57:case"end":return s.stop()}},s,null,[[5,17],[31,51]])}));return function(e,t){return s.apply(this,arguments)}}();if(t){var h=0,b=0;t.length&&((h=Math.floor(t.length/60))<10&&(h="0"+h),(b=Math.floor(t.length%60))<10&&(b="0"+b));var v="N/A";t.artist&&(v=t.artist);var E="N/A";t.album&&(E=t.album);var k="N/A";t.musicName&&(k=t.musicName);var y="";return e.reorder_mode&&(y=r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"25px"}},r.a.createElement(me.b,null))),r.a.createElement("div",null,r.a.createElement(H.a,null,r.a.createElement(T.a,{className:"border-bottom-accent"},r.a.createElement(z.a,{xs:1},y),r.a.createElement(z.a,{xs:3},k),r.a.createElement(z.a,{xs:2},v),r.a.createElement(z.a,{xs:3},E),r.a.createElement(z.a,{xs:1},h,":",b),r.a.createElement(z.a,{xs:1},r.a.createElement(Ee.a,{"aria-label":"play-song",onClick:function(t){(0,e.onSongCardClick)(0)}},r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"30px"}},r.a.createElement(me.k,null)))),r.a.createElement(z.a,{xs:1},r.a.createElement(Ee.a,{"aria-label":"more","aria-controls":"menu","aria-haspopup":"true",onClick:function(e){i(e.currentTarget)}},r.a.createElement(q.b.Provider,{value:{color:"#F06E9C",size:"30px"}},r.a.createElement(me.d,null))),r.a.createElement(Ce.a,{id:"menu",anchorEl:c,keepMounted:!0,open:Boolean(c),onClose:function(){i(null)}},ft.map(function(e,t){return r.a.createElement(Oe.a,{key:e,onClick:function(e){return g(e,t)}},e)}))))))}return r.a.createElement("div",null,"error")}var ht=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(g.a)(this,Object(h.a)(t).call(this,e))).state={},a}return Object(b.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(H.a,null,r.a.createElement(T.a,{className:"border-bottom-accent"},r.a.createElement(z.a,{xs:1}),r.a.createElement(z.a,{xs:3},r.a.createElement("span",null,"Title")),r.a.createElement(z.a,{xs:2},r.a.createElement("span",null,"Artist")),r.a.createElement(z.a,{xs:3},r.a.createElement("span",null,"Album")),r.a.createElement(z.a,{xs:2},r.a.createElement("span",null,"Time")),r.a.createElement(z.a,{xs:1},"Options"))))}}]),t}(n.Component);function bt(e){var t=r.a.useState(null),a=Object(Y.a)(t,2),s=(a[0],a[1],r.a.useState(null)),l=Object(Y.a)(s,2),c=l[0],i=l[1],o=r.a.useState(0),u=Object(Y.a)(o,2),p=u[0],f=u[1],g=r.a.useState(null),h=Object(Y.a)(g,2),b=h[0],v=h[1],E=r.a.useState(""),k=Object(Y.a)(E,2),y=(k[0],k[1]),x=r.a.useState(!1),S=Object(Y.a)(x,2),C=S[0],O=S[1],I=localStorage.getItem("userId"),N=function(e){var t=e.target;y(t.value)};Object(n.useEffect)(function(){function t(){return(t=Object(m.a)(d.a.mark(function t(){var a,n;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.match.params.id,t.next=3,L.get("/music/"+a);case 3:"success"===(n=t.sent).data.status?(i(n.data.music),f(n.data.music.length)):console.log("error searching song"),O(!0);case 6:case"end":return t.stop()}},t)}))).apply(this,arguments)}!function(){t.apply(this,arguments)}()},[]);var _=function(){var e=Object(m.a)(d.a.mark(function e(t,a){var n,r,s;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==(n=document.getElementById("musicListName").value)){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,L.post("/createMusicListWithMusics",{musicListName:n,musics:a,userId:I});case 6:if("success"!==(r=e.sent).data.status){e.next=13;break}return s=r.data.musicListId,e.next=11,L.post("/addMusicList",{musicListId:s,userId:I});case 11:"success"===e.sent.data.status&&P();case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),console.log(e.t0);case 18:case"end":return e.stop()}},e,null,[[3,15]])}));return function(t,a){return e.apply(this,arguments)}}(),j=function(t){if(localStorage.getItem("isSignedIn")){var a=document.getElementById("main_modal");if(a)a.style.display="block",(0,e.updateModalContentHandler)(r.a.createElement("div",null,r.a.createElement("h2",null,"Create New Playlist"),r.a.createElement("div",{style:{padding:"5px"}},r.a.createElement(J.a,{id:"musicListName",size:"small",placeholder:"New List",variant:"outlined",onChange:N})),r.a.createElement(B.a,{className:"search-btn",onClick:function(e){return _(e,t)}},"Create"),r.a.createElement(B.a,{className:"cancel-btn",onClick:P},"Cancel")))}else alert("Please sign in first!")},P=function(){document.getElementById("main_modal").style.display="none"},A=function(){var e=Object(m.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c&&j([c._id]);case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();if(null!==c){var M;M=r.a.createElement(gt,{updateModalContentHandler:function(e){v(e)},song:c,onSongCardClick:function(t){if(c){for(var a=e.loadQueueIndexToAudioPlayer,n=localStorage.getItem("queue"),r=!1,s=(n=n?JSON.parse(n):[]).length-1,l=0;l<n.length;l++)n[l]&&n[l]._id===c._id&&(r=!0,s=l);r||(n.push(c),s=n.length-1),localStorage.setItem("queue",JSON.stringify(n)),a(s)}}});var H=0;(H=Math.floor(p/3600))<10&&(H="0"+H);var F=0;(F=Math.floor(p/60))<10&&(F="0"+F);var q=0;return(q=Math.floor(p%60))<10&&(q="0"+q),r.a.createElement("div",null,r.a.createElement(T.a,null,r.a.createElement("img",{className:"playlist-image",src:w.a,width:175,height:175,alt:""}),r.a.createElement(z.a,null,r.a.createElement("h1",{style:{fontWeight:"bold"}}," ",c.musicName," "),r.a.createElement("h4",{style:{fontWeight:"bold"}},H,"h ",F,"m ",q,"s"),r.a.createElement(B.a,{className:"search-btn",onClick:A},"Save As Playlist"))),r.a.createElement(ht,null),M,r.a.createElement("div",{id:"modal",className:"modal"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("span",{onClick:function(){var e=document.getElementById("modal");e&&(e.style.display="none")},className:"close"},"\xd7"),b)))}return C?r.a.createElement("div",null,"Can't find this song."):r.a.createElement("div",null,"Loading...")}var vt=function(e){function t(){var e;return Object(p.a)(this,t),(e=Object(g.a)(this,Object(h.a)(t).call(this))).updateNowPlaying=function(t){e.setState({now_playing:t})},e.onModalClose=function(){document.getElementById("main_modal").style.display="none"},e.connectToSocket=function(){if(!e.state.main_socket){var t=P.url.server,a=V()(t,{withCredentials:!0,extraHeaders:{"my-custom-header":"abcd"}});e.setState({main_socket:a},function(){if(e.state.main_socket){var t=localStorage.getItem("userId");e.state.main_socket.emit("online",{user_id:t}),e.state.main_socket.on("online_users",function(){var t=Object(m.a)(d.a.mark(function t(a){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({online_users:a});case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())}})}},e.signedIn=function(){var t=Object(m.a)(d.a.mark(function t(a,n){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:console.log("signed in"),console.log(n),localStorage.setItem("isSignedIn",!0),localStorage.setItem("userId",n),localStorage.setItem("userNickName",a),localStorage.getItem("queue")||localStorage.setItem("queue",JSON.stringify([])),e.connectToSocket(),e.setState({signedUp:!0,nickName:a,userId:n,queue:[]});case 9:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}(),e.signedOut=function(){console.log("signed out"),e.state.main_socket&&e.state.main_socket.close(),window.location.href="/",localStorage.removeItem("isSignedIn"),localStorage.removeItem("userId"),localStorage.removeItem("userNickName"),localStorage.removeItem("queue"),e.setState({signedUp:!1,nickName:"",userId:"",queue:[]})},e.updateModalContentHandler=function(t){e.setState({modal_content:t})},e.loadQueueSongsToAudioPlayer=function(t){e.audioPlayer.loadSongAndplay(t,0)},e.loadQueueIndexToAudioPlayer=function(t){e.audioPlayer.loadQueueIndexAndPlay(t)},e.onScrollButtonClick=function(){window.scrollTo(0,document.body.scrollHeight)},e.state={signedUp:!1,nickName:"",userId:"",musicListId:"",queue:[],modal_content:null,main_socket:null,online_users:[],now_playing:"none"},e}return Object(b.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){!this.state.main_socket&&localStorage.getItem("isSignedIn")&&this.connectToSocket()}},{key:"componentWillUnmount",value:function(){this.state.main_socket&&this.state.main_socket.close()}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"primary-bg",style:{borderTop:"15px solid #F6D8FC"}},r.a.createElement(H.a,{style:{height:"100vh"}},r.a.createElement(pt,{nickName:this.state.nickName}),r.a.createElement(T.a,null,r.a.createElement(z.a,{xs:3},r.a.createElement(be,{userId:this.state.userId,signedUp:this.state.signedUp,signedOut:this.signedOut,updateModalContentHandler:this.updateModalContentHandler})),r.a.createElement(z.a,{xs:9,className:"white-bg",style:{height:"90vh",overflow:"scroll",overflowX:"hidden"}},r.a.createElement(v.c,null,r.a.createElement(v.a,{exact:!0,path:"/",component:A}),r.a.createElement(v.a,{path:"/friends",render:function(t){return r.a.createElement(U,Object.assign({},t,{online_users:e.state.online_users}))}}),r.a.createElement(v.a,{path:"/chat/:id",component:G}),r.a.createElement(v.a,{path:"/profile/:id",render:function(t){return r.a.createElement(tt,Object.assign({},t,{now_playing:e.state.now_playing,updateModalContentHandler:e.updateModalContentHandler}))}}),r.a.createElement(v.a,{path:"/playlists",render:function(t){return r.a.createElement(de,Object.assign({updateModalContentHandler:e.updateModalContentHandler,userId:e.state.userId},t,{isAuthed:!0}))}}),r.a.createElement(v.a,{path:"/playlist/:id",render:function(t){return r.a.createElement(He,Object.assign({updateMainModalContentHandler:e.updateModalContentHandler,loadQueueSongsToAudioPlayer:e.loadQueueSongsToAudioPlayer,userId:e.state.userId},t,{isAuthed:!0}))}}),r.a.createElement(v.a,{path:"/queue",render:function(t){return r.a.createElement(Be,Object.assign({loadQueueIndexToAudioPlayer:e.loadQueueIndexToAudioPlayer,updateModalContentHandler:e.updateModalContentHandler,queue:e.state.queue,userId:e.props.userId},t,{isAuthed:!0}))}}),r.a.createElement(v.a,{path:"/song/:id",render:function(t){return r.a.createElement(bt,Object.assign({loadQueueIndexToAudioPlayer:e.loadQueueIndexToAudioPlayer,updateModalContentHandler:e.updateModalContentHandler,userId:e.props.userId},t,{isAuthed:!0}))}}),r.a.createElement(v.a,{path:"/search",render:function(t){return r.a.createElement(et,Object.assign({loadQueueIndexToAudioPlayer:e.loadQueueIndexToAudioPlayer,userId:e.state.userId},t,{isAuthed:!0}))}}),r.a.createElement(v.a,{path:"/signin",render:function(t){return r.a.createElement(at,Object.assign({signedIn:e.signedIn},t,{isAuthed:!0}))}}),r.a.createElement(v.a,{path:"/signup",render:function(t){return r.a.createElement(lt,Object.assign({signedIn:e.signedIn},t,{isAuthed:!0}))}}),r.a.createElement(v.a,{path:"/forgetpassword",component:ct}),r.a.createElement(v.a,{path:"/changepassword/:id",component:ot}),r.a.createElement(v.a,{path:"/verification/:id",render:function(t){return r.a.createElement(it,Object.assign({signedIn:e.signedIn},t,{isAuthed:!0}))}}),r.a.createElement(v.a,{path:"/emailsent",component:ut}),r.a.createElement(v.a,{path:"/error",component:dt}))))),r.a.createElement("div",{id:"scroll-to-audio-right"},r.a.createElement(Ee.a,{style:{backgroundColor:"#F06E9C"},"aria-label":"scroll",onClick:this.onScrollButtonClick},r.a.createElement(q.b.Provider,{value:{color:"white",size:"50px"}},r.a.createElement(me.e,null)))),r.a.createElement(xe,{onRef:function(t){return e.audioPlayer=t},updateNowPlaying:this.updateNowPlaying}),r.a.createElement("div",{id:"main_modal",className:"modal"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("span",{onClick:this.onModalClose,className:"close"},"\xd7"),this.state.modal_content)),r.a.createElement("div",{id:"loading_toast"},"Loading..."),r.a.createElement("div",{id:"no_song_toast"},"This song doesn't have a preview. Playing our default song instead..."))}}]),t}(n.Component),Et=new c.a({uri:P.url.server+"/graphql"});l.a.render(r.a.createElement(i.a,{client:Et},r.a.createElement(o.a,null,r.a.createElement(vt,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},56:function(e,t,a){e.exports=a.p+"static/media/default_image.0ca2cfb4.png"},71:function(e,t,a){e.exports={url:{client:"https://mixtapez416.herokuapp.com",server:"https://mixtapez416.herokuapp.com"}}},78:function(e,t,a){e.exports=a.p+"static/media/AbbeyRoad.2328f774.jpg"},82:function(e){e.exports={users:[{id:"f06e905f9505e53017b5c953",userEmail:"tommy123@gmail.com",password:"ef797c8118f02dfb649607dd5d3f8c7623048c9c063d532cc95c5ed7a898a64f",nickName:"Tommy",friends:["17b5cf065e90953f9505e530","90953f9505e53017b5cf065e"],socketId:"f06e905f9505e530AAAA",nowListening:"0",favorites:["0"],tracks:["0","1"],lastUpdate:"10/10/2020 10:59:36"},{id:"17b5cf065e90953f9505e530",userEmail:"test@gmail.com",password:"ef797c8118f02dfb649607dd5d3f8c7623048c9c063d532cc95c5ed7a898a64f",nickName:"TestPerson",friends:["f06e905f9505e53017b5c953"],socketId:"f06e905f9505e530AAAB",nowListening:{},favorites:[],tracks:[],lastUpdate:"10/10/2020 10:59:36"},{id:"90953f9505e53017b5cf065e",userEmail:"user@gmail.com",password:"ef797c8118f02dfb649607dd5d3f8c7623048c9c063d532cc95c5ed7a898a64f",nickName:"User",friends:["f06e905f9505e53017b5c953"],socketId:null,nowListening:{},favorites:[],tracks:[],lastUpdate:"10/10/2020 10:59:36"}],PlayList:[{id:"0",userId:"f06e905f9505e53017b5c953",trackName:"My Track",musics:["0","2"],lastUpdate:"10/10/2020 10:59:36"},{id:"1",userId:"f06e905f9505e53017b5c953",trackName:"My Track2",musics:["1"],lastUpdate:"10/10/2020 10:59:36"}],music:[{id:"0",musicName:"Song",URI:"https://api.spotify.com/v1/tracks/0",album:"album1",artist:"Me",image:"https://images.macrumors.com/t/vMbr05RQ60tz7V_zS5UEO9SbGR0=/1600x900/smart/article-new/2018/05/apple-music-note.jpg",likes:10,lastUpdate:"10/10/2020 10:59:36",length:60},{id:"1",musicName:"Song2",URI:"https://api.spotify.com/v1/tracks/1",album:"album2",artist:"Me",image:"https://images.macrumors.com/t/vMbr05RQ60tz7V_zS5UEO9SbGR0=/1600x900/smart/article-new/2018/05/apple-music-note.jpg",likes:0,lastUpdate:"10/10/2020 10:59:36",length:60},{id:"2",musicName:"Song3",URI:"https://api.spotify.com/v1/tracks/2",album:"album1",artist:"Me",image:"https://images.macrumors.com/t/vMbr05RQ60tz7V_zS5UEO9SbGR0=/1600x900/smart/article-new/2018/05/apple-music-note.jpg",likes:1,lastUpdate:"10/10/2020 10:59:36",length:60}]}}},[[183,1,2]]]);
//# sourceMappingURL=main.4d8ff16b.chunk.js.map